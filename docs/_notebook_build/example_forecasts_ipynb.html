
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TIPS-Treasury Basis Spread Forecasting Walkthrough &#8212; Financial Time Series Forecasting Repository</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=37919675" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=e1a75a79"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_notebook_build/example_forecasts_ipynb';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Financial Time Series Forecasting Repository - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Financial Time Series Forecasting Repository - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Financial Time Series Forecasting Repository (FTSFR)
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ“š Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../data_sources_and_modules.html">Data Sources and Data Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ftsfr_datasets_info.html">FTSFR Datasets Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_glimpses.html">Data Glimpses Report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_glimpses_ftsfr.html">Data Glimpses Report: FTSFR only</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ“Š Data Cleaning Procedure Summaries</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="summary_cds_bond_basis_ipynb.html">Cleaning Summary: CDS Bond Basis</a></li>




<li class="toctree-l1"><a class="reference internal" href="summary_cds_returns_ipynb.html">Cleaning Summary: CDS Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary_cip_ipynb.html">Cleaning Summary: Covered Interest Parity (CIP) Arbitrage Spreads</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary_commodities.html">Cleaning Summary: Commodities Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary_corp_bond_returns_ipynb.html">Cleaning Summary: Corporate Bond Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spx_options_description.html">He, Kelly, Manela (HKM) Test Portfolios: Options</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleaning_options.html">Cleaning Summary: Options Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="combined_filters.html">Imports</a></li>



<li class="toctree-l2"><a class="reference internal" href="portfolios.html">Imports</a></li>


</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="summary_treasury_bond_returns_ipynb.html">Cleaning Summary: Treasury Bond Returns</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ”§ Development</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../myst_markdown_demos.html">MyST Markdown Demos ğŸ’¡</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jmbejara/ftsfr" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jmbejara/ftsfr/issues/new?title=Issue%20on%20page%20%2F_notebook_build/example_forecasts_ipynb.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/_notebook_build/example_forecasts_ipynb.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>TIPS-Treasury Basis Spread Forecasting Walkthrough</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">TIPS-Treasury Basis Spread Forecasting Walkthrough</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-prepare-data">Load and Prepare Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">Data Exploration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-full-time-series">Visualize the Full Time Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-test-split">Train/Test Split</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-models-for-comparison">Define Models for Comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-statsforecast">Initialize StatsForecast</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-point-forecasts">Generate Point Forecasts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-auto-neural-models">Fit Auto Neural Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combine-forecasts-across-all-models">Combine Forecasts Across All Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-forecasts-vs-actuals">Visualize Forecasts vs Actuals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#focus-on-specific-models">Focus on Specific Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-auto-neural-forecasts">Visualize Auto Neural Forecasts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation-for-robust-evaluation-commented-out-for-debugging">Cross-Validation for Robust Evaluation (COMMENTED OUT FOR DEBUGGING)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#instead-of-a-single-train-test-split-well-use-cross-validation-with-multiple">Instead of a single train/test split, weâ€™ll use cross-validation with multiple</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#windows-to-get-a-more-robust-assessment-of-model-performance">windows to get a more robust assessment of model performance.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#well-use">Weâ€™ll use:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#forecast-horizon-12-months-matching-the-held-out-forecast-horizon">- Forecast horizon: 12 months (matching the held-out forecast horizon)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#step-size-12-months-non-overlapping-windows">- Step size: 12 months (non-overlapping windows)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#up-to-5-windows-limited-by-data-length">- Up to 5 windows (limited by data length)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cv-horizon-forecast-horizon">cv_horizon = forecast_horizon</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#max-windows-max-1-len-y-df-cv-horizon-1">max_windows = max(1, (len(Y_df) // cv_horizon) - 1)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cv-windows-min-5-max-windows">cv_windows = min(5, max_windows)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stats-cv-df-sf-cross-validation">stats_cv_df = sf.cross_validation(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#df-y-df">df=Y_df,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#h-cv-horizon">h=cv_horizon,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#step-size-cv-horizon">step_size=cv_horizon,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#n-windows-cv-windows">n_windows=cv_windows,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stats-cv-df-head">stats_cv_df.head()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cross-validation">### Neural Cross-Validation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#refit-the-auto-neural-models-within-the-cross-validation-windows-to-evaluate">Refit the auto neural models within the cross-validation windows to evaluate</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#their-stability-across-different-training-periods">their stability across different training periods.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-models-build-auto-neural-models-cv-horizon-auto-logs-dir-cv">neural_cv_models = build_auto_neural_models(cv_horizon, auto_logs_dir / â€œcvâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nf-cv-neuralforecast-models-neural-cv-models-freq-bme">nf_cv = NeuralForecast(models=neural_cv_models, freq=â€œBMEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-df-nf-cv-cross-validation">neural_cv_df = nf_cv.cross_validation(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">df=Y_df,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">n_windows=cv_windows,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">step_size=cv_horizon,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-df-head">neural_cv_df.head()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id21"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id22"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#combine-cross-validation-results">### Combine Cross-Validation Results</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id25"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id26"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-df-no-target-neural-cv-df-drop-columns-col-for-col-in-y-if-col-in-neural-cv-df-columns">neural_cv_df_no_target = neural_cv_df.drop(columns=[col for col in [â€œyâ€] if col in neural_cv_df.columns])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cv-df-pd-merge">cv_df = pd.merge(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stats-cv-df">stats_cv_df,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-df-no-target">neural_cv_df_no_target,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#on-unique-id-ds-cutoff">on=[â€œunique_idâ€, â€œdsâ€, â€œcutoffâ€],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-inner">how=â€œinnerâ€,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cv-df-head">cv_df.head()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id28"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id29"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-model-performance">## Evaluate Model Performance</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id31"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-error-metrics-for-each-model-across-all-cross-validation-windows">Calculate error metrics for each model across all cross-validation windows:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-mean-absolute-scaled-error-scale-independent-metric">- MASE (Mean Absolute Scaled Error): Scale-independent metric</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-mean-squared-error-penalizes-large-errors">- MSE (Mean Squared Error): Penalizes large errors</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-root-mean-squared-error-in-same-units-as-original-data">- RMSE (Root Mean Squared Error): In same units as original data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id33"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id34"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-numpy-as-np">import numpy as np</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id35"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id36"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#def-select-point-forecast-columns-df">def select_point_forecast_columns(df):</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#return-the-forecast-columns-excluding-prediction-interval-outputs">â€œâ€â€œReturn the forecast columns excluding prediction interval outputs.â€â€œâ€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id37"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exclude-cols-unique-id-ds-y-cutoff">exclude_cols = {â€œunique_idâ€, â€œdsâ€, â€œyâ€, â€œcutoffâ€}</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#point-cols">point_cols = []</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id38"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#for-col-in-df-columns">for col in df.columns:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-col-in-exclude-cols">if col in exclude_cols:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#continue">continue</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id39"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#col-lower-col-lower">col_lower = col.lower()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-any-token-in-col-lower-for-token-in-lo-hi">if any(token in col_lower for token in [â€œ-lo-â€, â€œ-hi-â€]):</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">continue</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-col-lower-endswith-median">if col_lower.endswith(â€œ-medianâ€):</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">continue</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id42"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#point-cols-append-col">point_cols.append(col)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id43"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#return-point-cols">return point_cols</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id44"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id45"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mase-needs-training-data-for-scaling"># Calculate MASE (needs training data for scaling)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#for-mase-we-need-to-create-a-naive-forecast-baseline"># For MASE, we need to create a naive forecast baseline</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-training-data-to-compute-seasonal-naive-errors-for-scaling"># Use the training data to compute seasonal naive errors for scaling</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-scores">mase_scores = {}</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-scores">mse_scores = {}</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-scores">rmse_scores = {}</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id46"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-cols-select-point-forecast-columns-cv-df">model_cols = select_point_forecast_columns(cv_df)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id47"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#for-model-col-in-model-cols">for model_col in model_cols:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mse"># Calculate MSE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-mse-cv-df-y-cv-df-model-col-2-mean">model_mse = ((cv_df[â€œyâ€] - cv_df[model_col]) ** 2).mean()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-scores-model-col-model-mse">mse_scores[model_col] = model_mse</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-scores-model-col-np-sqrt-model-mse">rmse_scores[model_col] = np.sqrt(model_mse)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id48"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mase-using-seasonal-naive-as-baseline"># Calculate MASE (using seasonal naive as baseline)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-mae-mae-baseline-where-baseline-is-seasonal-naive"># MASE = MAE / MAE_baseline where baseline is seasonal naive</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mae-np-abs-cv-df-y-cv-df-model-col-mean">mae = np.abs(cv_df[â€œyâ€] - cv_df[model_col]).mean()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id49"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-naive-baseline-compare-with-value-from-season-length-periods-ago"># Seasonal naive baseline (compare with value from season_length periods ago)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#for-the-training-set"># For the training set</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#train-y-train-df-y-values">train_y = train_df[â€œyâ€].values</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-len-train-y-season-length">if len(train_y) &gt; season_length:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-errors-np-abs-train-y-season-length-train-y-season-length">naive_errors = np.abs(train_y[season_length:] - train_y[:-season_length])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#else">else:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-errors-np-abs-np-diff-train-y">naive_errors = np.abs(np.diff(train_y))</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mae-baseline-naive-errors-mean">mae_baseline = naive_errors.mean()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id50"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-scores-model-col-mae-mae-baseline-if-mae-baseline-0-else-np-inf">mase_scores[model_col] = mae / mae_baseline if mae_baseline &gt; 0 else np.inf</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id51"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id52"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-performance-summary">## Model Performance Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id54"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-all-models-across-the-three-metrics">Compare all models across the three metrics.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lower-values-are-better-for-all-metrics">Lower values are better for all metrics.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id55"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation">Interpretation:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-1-better-than-seasonal-naive-baseline">- MASE &lt; 1: Better than seasonal naive baseline</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-1-same-as-seasonal-naive">- MASE = 1: Same as seasonal naive</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-1-worse-than-seasonal-naive">- MASE &gt; 1: Worse than seasonal naive</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id56">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id57"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id58"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-pandas-as-pd">import pandas as pd</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id59"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id60"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#create-comparison-table"># Create comparison table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-df-pd-dataframe">comparison_df = pd.DataFrame({</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-model-cols">â€œModelâ€: model_cols,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-mase-scores-m-for-m-in-model-cols">â€œMASEâ€: [mase_scores[m] for m in model_cols],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-mse-scores-m-for-m-in-model-cols">â€œMSEâ€: [mse_scores[m] for m in model_cols],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-rmse-scores-m-for-m-in-model-cols">â€œRMSEâ€: [rmse_scores[m] for m in model_cols],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id61">})</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id62"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sort-by-mase-lower-is-better"># Sort by MASE (lower is better)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-df-comparison-df-sort-values-mase">comparison_df = comparison_df.sort_values(â€œMASEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-df">comparison_df</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id63"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id64"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id65">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-model-rankings">## Visualize Model Rankings</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id66"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-visual-comparison-of-model-performance-across-metrics">Create a visual comparison of model performance across metrics.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id67">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id68"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id69"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fig-axes-plt-subplots-1-3-figsize-15-5">fig, axes = plt.subplots(1, 3, figsize=(15, 5))</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id70"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase"># MASE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-barh-comparison-df-model-comparison-df-mase">axes[0].barh(comparison_df[â€œModelâ€], comparison_df[â€œMASEâ€])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-set-xlabel-mase">axes[0].set_xlabel(â€œMASEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-set-title-mean-absolute-scaled-error-n-lower-is-better">axes[0].set_title(â€œMean Absolute Scaled Error\n(Lower is Better)â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-axvline-x-1-0-color-r-linestyle-label-naive-baseline">axes[0].axvline(x=1.0, color=â€˜râ€™, linestyle=â€˜â€“â€™, label=â€˜Naive Baselineâ€™)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-legend">axes[0].legend()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id71"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse"># MSE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-1-barh-comparison-df-model-comparison-df-mse">axes[1].barh(comparison_df[â€œModelâ€], comparison_df[â€œMSEâ€])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-1-set-xlabel-mse">axes[1].set_xlabel(â€œMSEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-1-set-title-mean-squared-error-n-lower-is-better">axes[1].set_title(â€œMean Squared Error\n(Lower is Better)â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id72"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse"># RMSE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-2-barh-comparison-df-model-comparison-df-rmse">axes[2].barh(comparison_df[â€œModelâ€], comparison_df[â€œRMSEâ€])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-2-set-xlabel-rmse">axes[2].set_xlabel(â€œRMSEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-2-set-title-root-mean-squared-error-n-lower-is-better">axes[2].set_title(â€œRoot Mean Squared Error\n(Lower is Better)â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id73"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plt-tight-layout">plt.tight_layout()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-show-plot-example-forecasts-model-rankings-png">save_and_show_plot(â€œexample_forecasts_model_rankings.pngâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id74"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id75"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id76">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#identify-best-model">## Identify Best Model</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id77"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#select-the-model-with-the-lowest-mase-score-and-visualize-its-performance">Select the model with the lowest MASE score and visualize its performance.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id78">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id79"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id80"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-model-comparison-df-iloc-0-model">best_model = comparison_df.iloc[0][â€œModelâ€]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#print-f-best-performing-model-best-model">print(fâ€Best performing model: {best_model}â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#print-f-mase-comparison-df-iloc-0-mase-4f">print(fâ€MASE: {comparison_df.iloc[0][â€˜MASEâ€™]:.4f}â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#print-f-rmse-comparison-df-iloc-0-rmse-4f">print(fâ€RMSE: {comparison_df.iloc[0][â€˜RMSEâ€™]:.4f}â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id81"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id82"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-best-models-forecast-with-actuals"># Visualize best modelâ€™s forecast with actuals</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-combined-forecasts-df-combined-forecasts-df-unique-id-arb-2">best_forecast = combined_forecasts_df[combined_forecasts_df[â€œunique_idâ€] == â€œarb_2â€]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id83"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fig-ax-plt-subplots-figsize-12-5">fig, ax = plt.subplots(figsize=(12, 5))</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-plot-train-df-ds-train-df-y-label-train-color-tab-blue-alpha-0-6">ax.plot(train_df[â€œdsâ€], train_df[â€œyâ€], label=â€œTrainâ€, color=â€œtab:blueâ€, alpha=0.6)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-plot-test-df-ds-test-df-y-label-actual-test-color-black-linewidth-2">ax.plot(test_df[â€œdsâ€], test_df[â€œyâ€], label=â€œActual (Test)â€, color=â€œblackâ€, linewidth=2)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-plot">ax.plot(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-ds">best_forecast[â€œdsâ€],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-best-model">best_forecast[best_model],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#label-f-forecast-best-model">label=fâ€Forecast ({best_model})â€,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linewidth-2">linewidth=2,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id84">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id85"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lower-col-f-best-model-lo-90">lower_col = fâ€{best_model}-lo-90â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#upper-col-f-best-model-hi-90">upper_col = fâ€{best_model}-hi-90â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-lower-col-in-best-forecast-columns-and-upper-col-in-best-forecast-columns">if lower_col in best_forecast.columns and upper_col in best_forecast.columns:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-fill-between">ax.fill_between(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id86">best_forecast[â€œdsâ€],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-lower-col">best_forecast[lower_col],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-upper-col">best_forecast[upper_col],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-0-2">alpha=0.2,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#color-tab-orange">color=â€œtab:orangeâ€,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#label-90-interval">label=â€œ90% intervalâ€,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id87">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id88"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-set-title-f-best-model-best-model-forecast-vs-actual">ax.set_title(fâ€Best Model ({best_model}) Forecast vs Actualâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-set-xlabel-date">ax.set_xlabel(â€œDateâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-set-ylabel-basis-spread">ax.set_ylabel(â€œBasis Spreadâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-legend-loc-upper-left">ax.legend(loc=â€œupper leftâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id89">plt.tight_layout()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-show-plot-example-forecasts-best-model-png">save_and_show_plot(â€œexample_forecasts_best_model.pngâ€)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#insights-and-conclusions">Insights and Conclusions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-findings">Key Findings:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-individual-model-analysis">Appendix: Individual Model Analysis</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tips-treasury-basis-spread-forecasting-walkthrough">
<h1>TIPS-Treasury Basis Spread Forecasting Walkthrough<a class="headerlink" href="#tips-treasury-basis-spread-forecasting-walkthrough" title="Link to this heading">#</a></h1>
<p>This walkthrough demonstrates forecasting the 2-year TIPS-Treasury basis spread
using StatsForecast. The TIPS-Treasury basis represents the arbitrage spread
between Treasury Inflation-Protected Securities (TIPS) and nominal Treasury bonds.</p>
<p>This example helps us understand:</p>
<ul class="simple">
<li><p>How different statistical models perform on financial arbitrage spreads</p></li>
<li><p>Which models capture the mean-reversion patterns typical of basis spreads</p></li>
<li><p>Why certain models work well (or poorly) for this type of financial data</p></li>
</ul>
<p>Based on the Nixtla StatsForecast documentation walkthrough, adapted for
financial time series data from the ftsfr repository.</p>
<section id="data-overview">
<h2>Data Overview<a class="headerlink" href="#data-overview" title="Link to this heading">#</a></h2>
<p>The TIPS-Treasury basis dataset contains arbitrage spreads for different maturities:</p>
<ul class="simple">
<li><p>arb_2: 2-year maturity</p></li>
<li><p>arb_5: 5-year maturity</p></li>
<li><p>arb_10: 10-year maturity</p></li>
<li><p>arb_20: 20-year maturity</p></li>
</ul>
<p>For this walkthrough, weâ€™ll focus on the 2-year maturity (arb_2) to understand
how well different models can forecast this financial arbitrage spread.</p>
</section>
<section id="load-and-prepare-data">
<h2>Load and Prepare Data<a class="headerlink" href="#load-and-prepare-data" title="Link to this heading">#</a></h2>
<p>Load the TIPS-Treasury basis data and filter to the 2-year maturity.
The data is in long format with columns: unique_id, ds (timestamp), y (basis spread).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">neuralforecast</span><span class="w"> </span><span class="kn">import</span> <span class="n">NeuralForecast</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neuralforecast.auto</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">AutoDeepAR</span><span class="p">,</span>
    <span class="n">AutoNBEATS</span><span class="p">,</span>
    <span class="n">AutoNHITS</span><span class="p">,</span>
    <span class="n">AutoDLinear</span><span class="p">,</span>
    <span class="n">AutoNLinear</span><span class="p">,</span>
    <span class="n">AutoVanillaTransformer</span><span class="p">,</span>
    <span class="n">AutoTiDE</span><span class="p">,</span>
    <span class="n">AutoKAN</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">neuralforecast.losses.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">MAE</span><span class="p">,</span> <span class="n">DistributionLoss</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define path to data</span>
<span class="c1"># Handle both notebook and script contexts</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># When running as a script</span>
    <span class="n">REPO_ROOT</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="c1"># When running as a notebook, resolve from where notebook is executed</span>
    <span class="c1"># Notebook is in src/forecasting/, so go up 2 levels to repo root</span>
    <span class="n">REPO_ROOT</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>

<span class="n">data_path</span> <span class="o">=</span> <span class="n">REPO_ROOT</span> <span class="o">/</span> <span class="s2">&quot;_data/formatted/basis_tips_treas/ftsfr_tips_treasury_basis.parquet&quot;</span>

<span class="c1"># Define output directory for plots</span>
<span class="n">OUTPUT_DIR</span> <span class="o">=</span> <span class="n">REPO_ROOT</span> <span class="o">/</span> <span class="s2">&quot;_output&quot;</span>
<span class="n">PLOTS_DIR</span> <span class="o">=</span> <span class="n">OUTPUT_DIR</span> <span class="o">/</span> <span class="s2">&quot;forecasting&quot;</span> <span class="o">/</span> <span class="s2">&quot;paper&quot;</span>
<span class="n">PLOTS_DIR</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Allow importing helper utilities defined alongside this script</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">scripts_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="n">scripts_path</span> <span class="o">=</span> <span class="n">REPO_ROOT</span> <span class="o">/</span> <span class="s2">&quot;src&quot;</span> <span class="o">/</span> <span class="s2">&quot;forecasting&quot;</span>

<span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">scripts_path</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">scripts_path</span><span class="p">))</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">forecast_neural_auto</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">create_auto_config_deepar</span><span class="p">,</span>
    <span class="n">create_auto_config_nbeats</span><span class="p">,</span>
    <span class="n">create_auto_config_nhits</span><span class="p">,</span>
    <span class="n">create_auto_config_simple</span><span class="p">,</span>
    <span class="n">create_auto_config_transformer</span><span class="p">,</span>
    <span class="n">create_auto_config_tide</span><span class="p">,</span>
    <span class="n">create_auto_config_kan</span><span class="p">,</span>
    <span class="n">detect_hardware</span><span class="p">,</span>
<span class="p">)</span>


<span class="c1"># Helper function to save and show plots</span>
<span class="k">def</span><span class="w"> </span><span class="nf">save_and_show_plot</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save current plot to OUTPUT_DIR and then show it.&quot;&quot;&quot;</span>
    <span class="n">plot_path</span> <span class="o">=</span> <span class="n">PLOTS_DIR</span> <span class="o">/</span> <span class="n">filename</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved plot to </span><span class="si">{</span><span class="n">plot_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load data and filter to 2-year maturity</span>
<span class="n">df_raw</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
<span class="n">df_2yr</span> <span class="o">=</span> <span class="n">df_raw</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;unique_id&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;arb_2&quot;</span><span class="p">)</span>

<span class="c1"># Convert to pandas for StatsForecast</span>
<span class="n">Y_df</span> <span class="o">=</span> <span class="n">df_2yr</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>

<span class="c1"># Resample to monthly frequency (last business day of month)</span>
<span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">])</span>
<span class="n">Y_df</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ds&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;BME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;unique_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;arb_2&#39;</span>  <span class="c1"># Restore unique_id column</span>

<span class="c1"># Handle missing values (forward fill then backward fill if needed)</span>
<span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">Y_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> observations of 2-year TIPS-Treasury basis spread (monthly)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Date range: </span><span class="si">{</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">Y_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loaded 251 observations of 2-year TIPS-Treasury basis spread (monthly)
Date range: 2004-07-30 00:00:00 to 2025-05-30 00:00:00
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ds</th>
      <th>unique_id</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2004-07-30</td>
      <td>arb_2</td>
      <td>0.716810</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2004-08-31</td>
      <td>arb_2</td>
      <td>11.744060</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2004-09-30</td>
      <td>arb_2</td>
      <td>20.915437</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2004-10-29</td>
      <td>arb_2</td>
      <td>20.915437</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2004-11-30</td>
      <td>arb_2</td>
      <td>3.644108</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="data-exploration">
<h2>Data Exploration<a class="headerlink" href="#data-exploration" title="Link to this heading">#</a></h2>
<p>Before modeling, letâ€™s examine the data characteristics:</p>
<ul class="simple">
<li><p>Time series plot to see trends and volatility</p></li>
<li><p>Basic statistics</p></li>
<li><p>Check for missing values</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Summary Statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Missing values: </span><span class="si">{</span><span class="n">Y_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Summary Statistics:
count    251.000000
mean      23.456402
std       26.077828
min      -25.844433
25%        8.971010
50%       22.362704
75%       33.570076
max      229.326732
Name: y, dtype: float64

Missing values: 0
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-full-time-series">
<h2>Visualize the Full Time Series<a class="headerlink" href="#visualize-the-full-time-series" title="Link to this heading">#</a></h2>
<p>Plot the complete 2-year TIPS-Treasury basis spread to understand its behavior.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsforecast</span><span class="w"> </span><span class="kn">import</span> <span class="n">StatsForecast</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">StatsForecast</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/697c52ab81c1dc59ca1fd3ab74686368f988e05022d596b1894de42083ab4a36.png" src="../_images/697c52ab81c1dc59ca1fd3ab74686368f988e05022d596b1894de42083ab4a36.png" />
</div>
</div>
</section>
<section id="train-test-split">
<h2>Train/Test Split<a class="headerlink" href="#train-test-split" title="Link to this heading">#</a></h2>
<p>For financial data, weâ€™ll use the most recent portion for testing.
Weâ€™ll forecast the last 12 months.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test_size</span> <span class="o">=</span> <span class="mi">12</span>  <span class="c1"># 12 months</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="n">test_size</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">test_size</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training set: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> observations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test set: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> observations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test period: </span><span class="si">{</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training set: 239 observations
Test set: 12 observations
Test period: 2024-06-28 00:00:00 to 2025-05-30 00:00:00
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-models-for-comparison">
<h2>Define Models for Comparison<a class="headerlink" href="#define-models-for-comparison" title="Link to this heading">#</a></h2>
<p>We align this walkthrough with the model registry defined in
<code class="docutils literal notranslate"><span class="pre">models_config.toml</span></code>, focusing on the statistically oriented models plus the
auto-tuned neural networks:</p>
<p><strong>Statistical baselines:</strong></p>
<ol class="arabic simple">
<li><p><strong>HistoricAverage</strong> â€“ simple long-run mean.</p></li>
<li><p><strong>AutoARIMA</strong> â€“ seasonal ARIMA with automatic order selection.</p></li>
<li><p><strong>Simple Exponential Smoothing (SES)</strong> â€“ non-seasonal exponential smoothing.</p></li>
<li><p><strong>Theta</strong> â€“ decomposes the series with an annual seasonality component.</p></li>
</ol>
<p><strong>Auto-tuned neural networks (Optuna search):</strong>
5. <strong>Auto DeepAR</strong>
6. <strong>Auto N-BEATS</strong>
7. <strong>Auto N-HiTS</strong>
8. <strong>Auto DLinear</strong>
9. <strong>Auto NLinear</strong>
10. <strong>Auto Vanilla Transformer</strong>
11. <strong>Auto TiDE</strong>
12. <strong>Auto KAN</strong></p>
<p>All neural models reuse the Auto configurations from
<code class="docutils literal notranslate"><span class="pre">forecast_neural_auto.py</span></code>, trading compute time for stronger accuracy. Every
model uses a 12-month seasonality, matching the annual structure in
Treasury basis spreads (auction cycles, year-end flows, and inflation seasonality).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsforecast.models</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">HistoricAverage</span><span class="p">,</span>
    <span class="n">SeasonalNaive</span><span class="p">,</span>
    <span class="n">AutoARIMA</span><span class="p">,</span>
    <span class="n">SimpleExponentialSmoothing</span><span class="p">,</span>
    <span class="n">Theta</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set seasonality to annual (12 months per year)</span>
<span class="c1"># TIPS-Treasury basis spreads often exhibit annual patterns due to:</span>
<span class="c1"># - Tax effects and year-end flows</span>
<span class="c1"># - Treasury issuance cycles</span>
<span class="c1"># - Seasonal inflation patterns</span>
<span class="n">season_length</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">forecast_horizon</span> <span class="o">=</span> <span class="n">test_size</span>

<span class="c1"># Statistical models from the registry with informative aliases</span>
<span class="n">stats_models</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">HistoricAverage</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;HistAvg&quot;</span><span class="p">),</span>
    <span class="n">AutoARIMA</span><span class="p">(</span>
        <span class="n">season_length</span><span class="o">=</span><span class="n">season_length</span><span class="p">,</span>
        <span class="n">max_p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">max_q</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">max_P</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">max_Q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">seasonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">stepwise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">approximation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">max_order</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;ARIMA&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="c1"># SimpleExponentialSmoothing(alpha=0.1, alias=&quot;SES&quot;),  # Commented out for debugging</span>
    <span class="n">Theta</span><span class="p">(</span><span class="n">season_length</span><span class="o">=</span><span class="n">season_length</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;Theta&quot;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">stats_model_aliases</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">alias</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">stats_models</span><span class="p">]</span>

<span class="c1"># Detect available hardware once to reuse the auto model tuning utilities</span>
<span class="n">hardware_config</span> <span class="o">=</span> <span class="n">detect_hardware</span><span class="p">()</span>

<span class="c1"># Store lightning logs for the neural auto models under the repository output directory</span>
<span class="n">auto_logs_dir</span> <span class="o">=</span> <span class="p">(</span><span class="n">REPO_ROOT</span> <span class="o">/</span> <span class="s2">&quot;_output/forecasting/logs/example_forecasts&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

<span class="c1"># Number of Optuna trials per auto model (higher -&gt; better performance, more compute)</span>
<span class="n">auto_num_samples</span> <span class="o">=</span> <span class="mi">12</span>

<span class="k">def</span><span class="w"> </span><span class="nf">build_auto_neural_models</span><span class="p">(</span><span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">log_root</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the auto neural models with consistent configuration.&quot;&quot;&quot;</span>

    <span class="n">log_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">log_root</span><span class="p">)</span>
    <span class="n">log_root</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span>
        <span class="n">AutoDeepAR</span><span class="p">(</span>
            <span class="n">h</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">create_auto_config_deepar</span><span class="p">(</span>
                <span class="n">season_length</span><span class="p">,</span>
                <span class="n">lightning_logs_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">((</span><span class="n">log_root</span> <span class="o">/</span> <span class="s2">&quot;auto_deepar&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()),</span>
                <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hardware_config</span><span class="o">=</span><span class="n">hardware_config</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">loss</span><span class="o">=</span><span class="n">DistributionLoss</span><span class="p">(</span><span class="n">distribution</span><span class="o">=</span><span class="s2">&quot;Normal&quot;</span><span class="p">),</span>
            <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;optuna&quot;</span><span class="p">,</span>
            <span class="n">num_samples</span><span class="o">=</span><span class="n">auto_num_samples</span><span class="p">,</span>
            <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;DeepAR&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="c1"># AutoNBEATS(  # Commented out for debugging</span>
        <span class="c1">#     h=horizon,</span>
        <span class="c1">#     config=create_auto_config_nbeats(</span>
        <span class="c1">#         season_length,</span>
        <span class="c1">#         horizon,</span>
        <span class="c1">#         lightning_logs_dir=str((log_root / &quot;auto_nbeats&quot;).resolve()),</span>
        <span class="c1">#         debug=False,</span>
        <span class="c1">#         hardware_config=hardware_config,</span>
        <span class="c1">#     ),</span>
        <span class="c1">#     loss=MAE(),</span>
        <span class="c1">#     backend=&quot;optuna&quot;,</span>
        <span class="c1">#     num_samples=auto_num_samples,</span>
        <span class="c1">#     alias=&quot;NBEATS&quot;,</span>
        <span class="c1"># ),</span>
        <span class="c1"># AutoNHITS(  # Commented out for debugging</span>
        <span class="c1">#     h=horizon,</span>
        <span class="c1">#     config=create_auto_config_nhits(</span>
        <span class="c1">#         season_length,</span>
        <span class="c1">#         lightning_logs_dir=str((log_root / &quot;auto_nhits&quot;).resolve()),</span>
        <span class="c1">#         debug=False,</span>
        <span class="c1">#         hardware_config=hardware_config,</span>
        <span class="c1">#     ),</span>
        <span class="c1">#     loss=MAE(),</span>
        <span class="c1">#     backend=&quot;optuna&quot;,</span>
        <span class="c1">#     num_samples=auto_num_samples,</span>
        <span class="c1">#     alias=&quot;NHITS&quot;,</span>
        <span class="c1"># ),</span>
        <span class="n">AutoDLinear</span><span class="p">(</span>
            <span class="n">h</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">create_auto_config_simple</span><span class="p">(</span>
                <span class="n">season_length</span><span class="p">,</span>
                <span class="n">lightning_logs_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">((</span><span class="n">log_root</span> <span class="o">/</span> <span class="s2">&quot;auto_dlinear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()),</span>
                <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hardware_config</span><span class="o">=</span><span class="n">hardware_config</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">loss</span><span class="o">=</span><span class="n">MAE</span><span class="p">(),</span>
            <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;optuna&quot;</span><span class="p">,</span>
            <span class="n">num_samples</span><span class="o">=</span><span class="n">auto_num_samples</span><span class="p">,</span>
            <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;DLinear&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="c1"># AutoNLinear(  # Commented out for debugging</span>
        <span class="c1">#     h=horizon,</span>
        <span class="c1">#     config=create_auto_config_simple(</span>
        <span class="c1">#         season_length,</span>
        <span class="c1">#         lightning_logs_dir=str((log_root / &quot;auto_nlinear&quot;).resolve()),</span>
        <span class="c1">#         debug=False,</span>
        <span class="c1">#         hardware_config=hardware_config,</span>
        <span class="c1">#     ),</span>
        <span class="c1">#     loss=MAE(),</span>
        <span class="c1">#     backend=&quot;optuna&quot;,</span>
        <span class="c1">#     num_samples=auto_num_samples,</span>
        <span class="c1">#     alias=&quot;NLinear&quot;,</span>
        <span class="c1"># ),</span>
        <span class="n">AutoVanillaTransformer</span><span class="p">(</span>
            <span class="n">h</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">create_auto_config_transformer</span><span class="p">(</span>
                <span class="n">season_length</span><span class="p">,</span>
                <span class="n">lightning_logs_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">((</span><span class="n">log_root</span> <span class="o">/</span> <span class="s2">&quot;auto_vanilla_transformer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()),</span>
                <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hardware_config</span><span class="o">=</span><span class="n">hardware_config</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">loss</span><span class="o">=</span><span class="n">MAE</span><span class="p">(),</span>
            <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;optuna&quot;</span><span class="p">,</span>
            <span class="n">num_samples</span><span class="o">=</span><span class="n">auto_num_samples</span><span class="p">,</span>
            <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;Transformer&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">AutoTiDE</span><span class="p">(</span>
            <span class="n">h</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">create_auto_config_tide</span><span class="p">(</span>
                <span class="n">season_length</span><span class="p">,</span>
                <span class="n">lightning_logs_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">((</span><span class="n">log_root</span> <span class="o">/</span> <span class="s2">&quot;auto_tide&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()),</span>
                <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hardware_config</span><span class="o">=</span><span class="n">hardware_config</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">loss</span><span class="o">=</span><span class="n">MAE</span><span class="p">(),</span>
            <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;optuna&quot;</span><span class="p">,</span>
            <span class="n">num_samples</span><span class="o">=</span><span class="n">auto_num_samples</span><span class="p">,</span>
            <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;TiDE&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="c1"># AutoKAN(  # Commented out for debugging</span>
        <span class="c1">#     h=horizon,</span>
        <span class="c1">#     config=create_auto_config_kan(</span>
        <span class="c1">#         season_length,</span>
        <span class="c1">#         lightning_logs_dir=str((log_root / &quot;auto_kan&quot;).resolve()),</span>
        <span class="c1">#         debug=False,</span>
        <span class="c1">#         hardware_config=hardware_config,</span>
        <span class="c1">#     ),</span>
        <span class="c1">#     loss=MAE(),</span>
        <span class="c1">#     backend=&quot;optuna&quot;,</span>
        <span class="c1">#     num_samples=auto_num_samples,</span>
        <span class="c1">#     alias=&quot;KAN&quot;,</span>
        <span class="c1"># ),</span>
    <span class="p">]</span>


<span class="n">neural_models</span> <span class="o">=</span> <span class="n">build_auto_neural_models</span><span class="p">(</span><span class="n">forecast_horizon</span><span class="p">,</span> <span class="n">auto_logs_dir</span><span class="p">)</span>

<span class="n">neural_model_aliases</span> <span class="o">=</span> <span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">neural_models</span><span class="p">]</span>

<span class="n">model_names</span> <span class="o">=</span> <span class="n">stats_model_aliases</span> <span class="o">+</span> <span class="n">neural_model_aliases</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Models to evaluate: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hardware detected:
  CPUs: 16
  CUDA GPUs: 0
  MPS available: True
  Using Apple MPS GPU training
  Data loading workers: 4
  Optuna parallel jobs: 4
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Models to evaluate: HistAvg, ARIMA, Theta, DeepAR, DLinear, Transformer, TiDE
</pre></div>
</div>
</div>
</div>
</section>
<section id="initialize-statsforecast">
<h2>Initialize StatsForecast<a class="headerlink" href="#initialize-statsforecast" title="Link to this heading">#</a></h2>
<p>Create the StatsForecast object with:</p>
<ul class="simple">
<li><p>Our selected models</p></li>
<li><p>Business month end frequency (BME)</p></li>
<li><p>Parallel processing for speed</p></li>
<li><p>SeasonalNaive as fallback if any model fails</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sf</span> <span class="o">=</span> <span class="n">StatsForecast</span><span class="p">(</span>
    <span class="n">models</span><span class="o">=</span><span class="n">stats_models</span><span class="p">,</span>
    <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;BME&quot;</span><span class="p">,</span>  <span class="c1"># Business month end frequency</span>
    <span class="n">fallback_model</span><span class="o">=</span><span class="n">SeasonalNaive</span><span class="p">(</span><span class="n">season_length</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># Simple fallback (non-seasonal)</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Use all available cores</span>
<span class="p">)</span>
<span class="n">sf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>StatsForecast(models=[HistAvg,ARIMA,Theta])
</pre></div>
</div>
</div>
</div>
</section>
<section id="generate-point-forecasts">
<h2>Generate Point Forecasts<a class="headerlink" href="#generate-point-forecasts" title="Link to this heading">#</a></h2>
<p>Use the full training data to generate forecasts for the test period.
Weâ€™ll include 90% prediction intervals to assess uncertainty.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stats_forecasts_df</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">train_df</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">])</span>
<span class="n">stats_forecasts_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_id</th>
      <th>ds</th>
      <th>HistAvg</th>
      <th>HistAvg-lo-90</th>
      <th>HistAvg-hi-90</th>
      <th>ARIMA</th>
      <th>ARIMA-lo-90</th>
      <th>ARIMA-hi-90</th>
      <th>Theta</th>
      <th>Theta-lo-90</th>
      <th>Theta-hi-90</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>arb_2</td>
      <td>2024-06-28</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>17.964419</td>
      <td>-6.617129</td>
      <td>42.545967</td>
      <td>24.988881</td>
      <td>-3.406585</td>
      <td>60.804602</td>
    </tr>
    <tr>
      <th>1</th>
      <td>arb_2</td>
      <td>2024-07-31</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>16.558516</td>
      <td>-20.490939</td>
      <td>53.607972</td>
      <td>29.972844</td>
      <td>-12.755830</td>
      <td>74.388970</td>
    </tr>
    <tr>
      <th>2</th>
      <td>arb_2</td>
      <td>2024-08-30</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>17.926385</td>
      <td>-25.047642</td>
      <td>60.900412</td>
      <td>31.051118</td>
      <td>-30.850561</td>
      <td>83.230372</td>
    </tr>
    <tr>
      <th>3</th>
      <td>arb_2</td>
      <td>2024-09-30</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>18.466627</td>
      <td>-29.020012</td>
      <td>65.953265</td>
      <td>32.683670</td>
      <td>-29.449171</td>
      <td>86.350302</td>
    </tr>
    <tr>
      <th>4</th>
      <td>arb_2</td>
      <td>2024-10-31</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>16.652616</td>
      <td>-35.490638</td>
      <td>68.795869</td>
      <td>32.711856</td>
      <td>-31.470616</td>
      <td>97.486275</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="fit-auto-neural-models">
<h2>Fit Auto Neural Models<a class="headerlink" href="#fit-auto-neural-models" title="Link to this heading">#</a></h2>
<p>Run the Optuna-powered auto neural networks using the same training window.
The helper configs from <code class="docutils literal notranslate"><span class="pre">forecast_neural_auto.py</span></code> provide tuned search spaces
and hardware-aware Lightning settings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nf</span> <span class="o">=</span> <span class="n">NeuralForecast</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="n">neural_models</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;BME&quot;</span><span class="p">)</span>
<span class="n">nf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">train_df</span><span class="p">)</span>

<span class="n">neural_forecasts_df</span> <span class="o">=</span> <span class="n">nf</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="n">neural_forecasts_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:25:36,020] A new study created in memory with name: no-name-df0833b0-90b1-4ee0-bcea-c7e7fc775395
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 18
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 331 K  | train
5 | decoder      | Decoder          | 258    | train
----------------------------------------------------------
331 K     Trainable params
10        Non-trainable params
331 K     Total params
1.326     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "33a0c6fb549b44a18bd27ebfe6e12e28", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3052efdf897f42c3a688acae55cc015b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "dcf950dccbac457296eda9076ae4ce5d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2d54405c043047c380d1dae2fc46c333", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "56cc6d640f4747459cfc6fe457275e43", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "63f7e677278e4955b285fd7240b56c30", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5dc008c84a3c419eaf1fa652f8aad355", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "fa14b386326944ceaf47f26bfecc576f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f0d0bbcbaf1a4cec81923f00fce51439", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "00199f46e60d4b148e400d8fb6bfe975", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a6c4ed140756460c825be25322845931", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "36c3f21660214837a68663929378fb13", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:25:59,600] Trial 0 finished with value: 1185.0650634765625 and parameters: {&#39;input_size&#39;: 12, &#39;lstm_hidden_size&#39;: 128, &#39;lstm_n_layers&#39;: 3, &#39;lstm_dropout&#39;: 0.14814146229497432, &#39;learning_rate&#39;: 0.00028311449097432603, &#39;scaler_type&#39;: &#39;standard&#39;, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 18}. Best is trial 0 with value: 1185.0650634765625.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 1.3 M  | train
5 | decoder      | Decoder          | 514    | train
----------------------------------------------------------
1.3 M     Trainable params
10        Non-trainable params
1.3 M     Total params
5.274     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "82fb0926d63646528f75bdcf602cf569", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "871c9215a5c44ebda4f6fd0e55055a0e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3008884724494337aa59b0ba72198cce", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "650659dee259447cb5f04423c69ac845", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3c28039b881b493d9f43e287f85072dd", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3a2dcd96212545e3b8271e0a8d6b4e50", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1e13fedf7a704a67a8dce9609878c0f2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "39c0482fe96c4c0a91d82ab756fa9204", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "dc0ee507e64d432194863f59979be593", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e22ae5b2c587498b9a220b0241cd1183", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c0200890bc3944518fdc64a1717b3ee3", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f80a0f4607ad433f8e7749b81eab0546", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:26:27,800] Trial 1 finished with value: 1070.7252197265625 and parameters: {&#39;input_size&#39;: 12, &#39;lstm_hidden_size&#39;: 256, &#39;lstm_n_layers&#39;: 3, &#39;lstm_dropout&#39;: 0.15167550810967032, &#39;learning_rate&#39;: 0.00039153588825878953, &#39;scaler_type&#39;: &#39;standard&#39;, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 10}. Best is trial 1 with value: 1070.7252197265625.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 12
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 199 K  | train
5 | decoder      | Decoder          | 258    | train
----------------------------------------------------------
199 K     Trainable params
10        Non-trainable params
199 K     Total params
0.798     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "39733d958cf949f4bc3c7d95649de923", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1a7034f964ea4b3fbf02bb0d3588bc8a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b4c5f3ebe1df4d2e9ab145e34e8840e7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "8c8cdf1d139f404ca7a80c50f6aa3509", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "70963e6bd0f14ffdb905f4bb26490f9f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ef80fd52e5774d3aa70e744d5332fbef", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "af6e57f41533421dacb3b961ab770ac0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "733851f08bb4482bbbc4c1d045d60e36", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5f61db21ad5c4ac598c721480095d42b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e1f5dadc2d274741a92eee0bbd33078a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b02849039ba04130a50f44c95eff2a8c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0b928635769546fb811fd313b469312d", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:26:56,818] Trial 2 finished with value: 512.5252075195312 and parameters: {&#39;input_size&#39;: 48, &#39;lstm_hidden_size&#39;: 128, &#39;lstm_n_layers&#39;: 2, &#39;lstm_dropout&#39;: 0.11388667194996528, &#39;learning_rate&#39;: 0.00011620054111988275, &#39;scaler_type&#39;: &#39;robust&#39;, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 128, &#39;random_seed&#39;: 12}. Best is trial 2 with value: 512.5252075195312.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 15
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 50.4 K | train
5 | decoder      | Decoder          | 130    | train
----------------------------------------------------------
50.6 K    Trainable params
10        Non-trainable params
50.6 K    Total params
0.202     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "68e4af2ab56845d6b4ad08a5e517a4d7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "355d2325089a487da93c37b9229bd87b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0ec87b009eee415ea4575675872abc03", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "11ca3d3760e74f4aababf65dc1ae6236", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "03dd9c44d8e04473a1fd61b0d650592d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c1d7142fc2f94c77bc2ae9b80c6129ea", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f5badad53b62438db66230493d250e10", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f5f755cd8fe34acd9a23865957178657", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6521b0c15bff4032aeef933777bd16af", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e94bd7e5c7204400b5d6b8794f66d0c8", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d8d839a5b01846b1a44042a2dcd430c6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d46c50d20789401493303331e0e7251a", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:27:16,403] Trial 3 finished with value: 626.4417114257812 and parameters: {&#39;input_size&#39;: 12, &#39;lstm_hidden_size&#39;: 64, &#39;lstm_n_layers&#39;: 2, &#39;lstm_dropout&#39;: 0.2138173202733064, &#39;learning_rate&#39;: 0.00024076567312958329, &#39;scaler_type&#39;: &#39;robust&#39;, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 15}. Best is trial 2 with value: 512.5252075195312.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 17
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 199 K  | train
5 | decoder      | Decoder          | 258    | train
----------------------------------------------------------
199 K     Trainable params
10        Non-trainable params
199 K     Total params
0.798     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3e1dfc9c31484491b906d1fa9da5f744", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "97081d9ebd964be7b62fc37bbcf3c054", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "751165641c8646eba854111ae04ed690", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d3eba150388d429690e4d59bb2170187", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "74867274591f48fdb5172b5e9060d8d2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0bee47ab8702429d97796196d4cb748e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "4c1694838a13413bb9b907904045ba83", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:27:30,684] Trial 4 finished with value: 459.657470703125 and parameters: {&#39;input_size&#39;: 48, &#39;lstm_hidden_size&#39;: 128, &#39;lstm_n_layers&#39;: 2, &#39;lstm_dropout&#39;: 0.3284460076709125, &#39;learning_rate&#39;: 0.004421473955999761, &#39;scaler_type&#39;: &#39;robust&#39;, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 17}. Best is trial 4 with value: 459.657470703125.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 12
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 50.4 K | train
5 | decoder      | Decoder          | 130    | train
----------------------------------------------------------
50.6 K    Trainable params
10        Non-trainable params
50.6 K    Total params
0.202     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "70a77cf21b4140928dbd9c79763ea8f3", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2c14e93cd9304f98bfacecdaf0c507a9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "afb31aa93b3e4c879df130bcf44e21d5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3cafc3698d3f4e509cad3d30b37a13dc", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b66b11521abe4756ad59d39a26a6a62c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "79c8aae130ee4968b4db606e863983ce", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e2055e5d83924aefbdf4dccede2d9a3b", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:27:43,426] Trial 5 finished with value: 1274.7027587890625 and parameters: {&#39;input_size&#39;: 24, &#39;lstm_hidden_size&#39;: 64, &#39;lstm_n_layers&#39;: 2, &#39;lstm_dropout&#39;: 0.3750395119967554, &#39;learning_rate&#39;: 0.0012210475528024924, &#39;scaler_type&#39;: &#39;robust&#39;, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 12}. Best is trial 4 with value: 459.657470703125.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 19
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 791 K  | train
5 | decoder      | Decoder          | 514    | train
----------------------------------------------------------
792 K     Trainable params
10        Non-trainable params
792 K     Total params
3.168     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3fd5bef2a4534f459c6acf38ae8cb45c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7c1cc4c33f6040b5acc17293e02aca57", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "21cd5c5ef61f4dc1bb9ad8eb6dcaa9a1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bc83d353f501420e924ca9e80109a034", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d1b8e02729f344e5a9fa1e2f096f46b1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6470bcdec1f543e88766815862514d70", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bf58bac2bbbf475b981e8ef0c15582dd", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:27:59,483] Trial 6 finished with value: 932.81298828125 and parameters: {&#39;input_size&#39;: 24, &#39;lstm_hidden_size&#39;: 256, &#39;lstm_n_layers&#39;: 2, &#39;lstm_dropout&#39;: 0.3695573403451168, &#39;learning_rate&#39;: 0.0004905177718345178, &#39;scaler_type&#39;: &#39;standard&#39;, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 128, &#39;random_seed&#39;: 19}. Best is trial 4 with value: 459.657470703125.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 1.3 M  | train
5 | decoder      | Decoder          | 514    | train
----------------------------------------------------------
1.3 M     Trainable params
10        Non-trainable params
1.3 M     Total params
5.274     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "787ace70a4e8484d8b4f78bc27623a9c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c3bedaceb8bc4366bf7195190f8b71cf", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5824bb25ccef4826a73ede7d104777b3", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5531e217b8964134bfc6f503007a1352", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9504fef034f34028a11000ee90061944", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "39b98e61bfc848ad99732d087f0e24f1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b40fdd71a48b4a94b71e22b4ab5bbe9d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b2106dffb91946b6a2eb0bfe86ed20c6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2e8f3fdfbc97420186ef44bee0eaaba1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5e9f741cdb6a41f8a1ef1d694cffc35f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cd09bef09d8b4864a25ac32f3e99b6fa", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "82e532ba550649c4b2579c34ee2324f0", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:28:30,039] Trial 7 finished with value: 449.7289123535156 and parameters: {&#39;input_size&#39;: 12, &#39;lstm_hidden_size&#39;: 256, &#39;lstm_n_layers&#39;: 3, &#39;lstm_dropout&#39;: 0.34970989312015094, &#39;learning_rate&#39;: 0.00014760546849156318, &#39;scaler_type&#39;: &#39;robust&#39;, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 128, &#39;random_seed&#39;: 8}. Best is trial 7 with value: 449.7289123535156.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 14
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 83.7 K | train
5 | decoder      | Decoder          | 130    | train
----------------------------------------------------------
83.8 K    Trainable params
10        Non-trainable params
83.9 K    Total params
0.335     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5d4ef17c870e4879a42e5754a09528df", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "65fc08a2929f4315bfbef259b37b2af0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6f182f20316a4653b1f718e6e05710bc", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "26b2f58045e34df9a03e9a509e9ffe2c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1ddab5704d3c4576b2d463b67d79f2d1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f02a90565a894db5a83d2b9d2f24e293", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "737e5a1b1c7b45d4902b6cbcface0a3e", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:28:41,922] Trial 8 finished with value: 456.9532165527344 and parameters: {&#39;input_size&#39;: 12, &#39;lstm_hidden_size&#39;: 64, &#39;lstm_n_layers&#39;: 3, &#39;lstm_dropout&#39;: 0.29432540178180616, &#39;learning_rate&#39;: 0.0013914459144572392, &#39;scaler_type&#39;: &#39;robust&#39;, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 128, &#39;random_seed&#39;: 14}. Best is trial 7 with value: 449.7289123535156.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 19
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 331 K  | train
5 | decoder      | Decoder          | 258    | train
----------------------------------------------------------
331 K     Trainable params
10        Non-trainable params
331 K     Total params
1.326     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cef1294cce62459087c4204c9b1742fb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "85356a9d81d54765adcfd87607591319", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1ad7c45b9c5848b5956c18aa71611011", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6c6927d7d4b1497da0bb3425d13f180d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7b1d0803ad6b4e41a31a30a3e9b7f46d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "be4a75ed579c434ab34c51b650230766", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "df651f8426bc4a9b986df38ca6eb64a3", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:28:52,364] Trial 9 finished with value: 524.313232421875 and parameters: {&#39;input_size&#39;: 12, &#39;lstm_hidden_size&#39;: 128, &#39;lstm_n_layers&#39;: 3, &#39;lstm_dropout&#39;: 0.27761446105513854, &#39;learning_rate&#39;: 0.0005087043571900063, &#39;scaler_type&#39;: &#39;standard&#39;, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 128, &#39;random_seed&#39;: 19}. Best is trial 7 with value: 449.7289123535156.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 1.3 M  | train
5 | decoder      | Decoder          | 514    | train
----------------------------------------------------------
1.3 M     Trainable params
10        Non-trainable params
1.3 M     Total params
5.274     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d4045253be8f4f3daaa457f76379d7e3", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "63c7d36ef4c543b2a7442ec0d7aa1e90", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "800176c15b814571af5adbf2d64949dd", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "030bb3c3025944079f94bd98b0a677ee", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "18df42669e274b68aa57110876f8218e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a8700f81f0804194a784f465190754a5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "97749fa55a90482f9f62b52de01d2b4f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "812d7b25705347789d03ee992e815096", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5434fe03cfd049af80aaa86dc7bec854", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0c32a76b6975485f88c8aa59d3deb949", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "691e4e89f91342338079d880aa662346", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2a5f930411684183b9a0d992f3f50598", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:29:39,843] Trial 10 finished with value: 321.9958801269531 and parameters: {&#39;input_size&#39;: 24, &#39;lstm_hidden_size&#39;: 256, &#39;lstm_n_layers&#39;: 3, &#39;lstm_dropout&#39;: 0.21203535849753413, &#39;learning_rate&#39;: 0.008125336412156977, &#39;scaler_type&#39;: &#39;robust&#39;, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 128, &#39;random_seed&#39;: 4}. Best is trial 10 with value: 321.9958801269531.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 1.3 M  | train
5 | decoder      | Decoder          | 514    | train
----------------------------------------------------------
1.3 M     Trainable params
10        Non-trainable params
1.3 M     Total params
5.274     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f8448ab53dea406d9c4807ea3e6af883", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5e547ff54fa74de2979b308f56012b83", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "aa35e3f197c1485e907525dc16012348", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "71794bac2a154d6bb3d8ac72dbeafe6b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9bff7b973e1d4fa992298039686b0f61", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ac50c84cc578481ebf9e9ef5604941cb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "218b13ed9b954556a74aa50118d9e5f9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "237a96d9cfb84fe59fb51aa2fd8d546e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "56f7258470b848bcb7bd1049fcfc3a98", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ad245013f4c44088fc9012fda9edbfd", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "26368e1d4a0f4b8ea4d46fbb493923e9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0c740cc75fa646b29cd252cd7ef03855", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:30:39,139] Trial 11 finished with value: 282.8189392089844 and parameters: {&#39;input_size&#39;: 24, &#39;lstm_hidden_size&#39;: 256, &#39;lstm_n_layers&#39;: 3, &#39;lstm_dropout&#39;: 0.2082352747602957, &#39;learning_rate&#39;: 0.006477699261803735, &#39;scaler_type&#39;: &#39;robust&#39;, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 128, &#39;random_seed&#39;: 4}. Best is trial 11 with value: 282.8189392089844.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name         | Type             | Params | Mode 
----------------------------------------------------------
0 | loss         | DistributionLoss | 5      | train
1 | valid_loss   | MQLoss           | 5      | train
2 | padder_train | ConstantPad1d    | 0      | train
3 | scaler       | TemporalNorm     | 0      | train
4 | hist_encoder | LSTM             | 1.3 M  | train
5 | decoder      | Decoder          | 514    | train
----------------------------------------------------------
1.3 M     Trainable params
10        Non-trainable params
1.3 M     Total params
5.274     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "92b031f9e5cf468ea135060ed6f69098", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "08fa1b7c19a34a5e9643926abac54465", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "552b409ac84f40eb80ae2058ef1bbf0d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "067bd864ec114a20be1257cd5aaf06d1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e623e7f3971346d5bd7f962e908b3ab3", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "8631fc87e98f4852b9da42d28700df96", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6d00a4f0901f447f8021cdab530af88d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "57300f256b2141bd8561322b52ecf214", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7bc8548199814dd2a44d6952b511131c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cdc20d58fe064cdab8e147c0d2553d0f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "11e70d02a8d84f1b8c6ba14fed6369ec", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "919d7cdd47774c0a9df0b9015ffcb0af", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:31:48,755] A new study created in memory with name: no-name-5a889e26-44e1-47f1-9f9f-f30d2f3ff7e3
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 300    | train
5 | linear_season | Linear        | 300    | train
--------------------------------------------------------
600       Trainable params
0         Non-trainable params
600       Total params
0.002     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0c04f87f18f34b5e88aae8b766fb6c95", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3a72560258ce4e3589d38589225bf839", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "63fb7e3a334e47cd81693bf8a89f3dea", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "14e79707174d4bbfba469672241d6ae0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "44342d3afc9c40afb2490646579e5636", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "890ff1bd02254e5b9b985d3ca7d31f4d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2c7ce5512c2d4604b1b5af048ff18ffc", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:31:53,774] Trial 0 finished with value: 8.197251319885254 and parameters: {&#39;input_size&#39;: 24, &#39;learning_rate&#39;: 0.00011108803214560526, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 1}. Best is trial 0 with value: 8.197251319885254.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 156    | train
5 | linear_season | Linear        | 156    | train
--------------------------------------------------------
312       Trainable params
0         Non-trainable params
312       Total params
0.001     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f8d88da0433e4e2dab048df7d6f6c39e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "eb7cefc569d7495ba13d9ec77771f9aa", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e6a2c85195244d079bde7eb597afdc10", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "783b8adff0224881a47a432bcdb17509", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "dda35f57f6b9412dac6528aeadf8273d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9bbb88dc60b741b198da7ca1e610bc5e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0085a19a3afc4e05b31c3a3bbedb238c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7849d57f452a4c43961fb5fe2187a600", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e7bff9ec50dd49eda07e17e436dfd39a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "92f88ec775a646c89171794325e62bf6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6e9f92f3d011434690db2c6139578e1e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "4075d076f0844136b69599eb04d6ea9d", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:32:03,233] Trial 1 finished with value: 10.984793663024902 and parameters: {&#39;input_size&#39;: 12, &#39;learning_rate&#39;: 0.000507278051754444, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 2}. Best is trial 0 with value: 8.197251319885254.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 156    | train
5 | linear_season | Linear        | 156    | train
--------------------------------------------------------
312       Trainable params
0         Non-trainable params
312       Total params
0.001     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e61d82d910514e56a986653b9b86b040", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "73ef7b8d08fb45b2a55dce147eb8e105", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f1e46086a63f42d1ba2fe36bd3741de9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "886dfa10150b4608b7891f9bb667871d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a4a07693d2314dd7ba19d2c19bee0630", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "16137bdb3f134fbaa0de0c7c193787c6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b4246472bd4b4547a89ebe4192ecea0e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e863b445867d4ba580e806aaec60255f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1cfad711afc34450bb8fee15b57b438a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "71679adaf0b6462088a5f9e65f406c2a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "adcb397d05dc46d6bb6be480bf7b6d13", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d416ee4095d84b8fa784788c6b8ffac0", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:32:13,296] Trial 2 finished with value: 11.156547546386719 and parameters: {&#39;input_size&#39;: 12, &#39;learning_rate&#39;: 0.0029855762399244655, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 2}. Best is trial 0 with value: 8.197251319885254.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 156    | train
5 | linear_season | Linear        | 156    | train
--------------------------------------------------------
312       Trainable params
0         Non-trainable params
312       Total params
0.001     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1411b8b1bb0e4b5395ad303a66ceb3ba", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "71d830a140634eb08ab08e2fb404a2c4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bb4b72d93725481492f4461d95e1d850", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "06533e76f09a4527addfd1c48cc8e14d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "46777504e8864d2694da950f98acfc8c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b01aea6627a64db1abb4c49257b08663", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cb459f77b2204675862567e74d10fa07", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a55291442b8543ba85a31d34ddb96122", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "73d3aab9774f42cf85a84f89a3bce003", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5840a276e99946c892067334f9739b49", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "298adb66afb248619014f5a427514cb9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d7692b990416479096d8f0a124d26762", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:32:22,505] Trial 3 finished with value: 11.34460735321045 and parameters: {&#39;input_size&#39;: 12, &#39;learning_rate&#39;: 0.0009581200610342949, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 4}. Best is trial 0 with value: 8.197251319885254.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 588    | train
5 | linear_season | Linear        | 588    | train
--------------------------------------------------------
1.2 K     Trainable params
0         Non-trainable params
1.2 K     Total params
0.005     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e6fa1fc386f64be185e92aba088db15b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bcaef70fb3ba4a16a093b4c9ba6f1fde", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "53af00c3c0cb423fa684dffdc9c3803c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "dd1186ed63514e558116c48fa66be78a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "4b4f9b68a2aa4faf9ecbfb27a19a5f8c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e773f638fb98493783bc4efa0b971f24", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f3310969bf3044baadb2b033b5c9080b", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:32:27,169] Trial 4 finished with value: 9.864205360412598 and parameters: {&#39;input_size&#39;: 48, &#39;learning_rate&#39;: 0.0013989246343292644, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 10}. Best is trial 0 with value: 8.197251319885254.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 13
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 300    | train
5 | linear_season | Linear        | 300    | train
--------------------------------------------------------
600       Trainable params
0         Non-trainable params
600       Total params
0.002     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "74ef67968fe744fb98eb5525fc48f549", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "21c13c94f72e4c6b8ae88f88365e97ec", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "179ede1878404f8b91c7dc1b9d08e1f4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2d46af1ea52642418d9e20ace9ec6ffd", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "32144b16a1714255a2f8b55bf7086130", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "473beacad4ed45478a75597184063718", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2ff79e82f9d24b3e9f68acda7758bd34", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:32:31,751] Trial 5 finished with value: 6.452488422393799 and parameters: {&#39;input_size&#39;: 24, &#39;learning_rate&#39;: 0.008204557819000924, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 13}. Best is trial 5 with value: 6.452488422393799.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 17
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 156    | train
5 | linear_season | Linear        | 156    | train
--------------------------------------------------------
312       Trainable params
0         Non-trainable params
312       Total params
0.001     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f01245a06d0a4c4eb8543be1b2e2b600", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "dab1f504145048148f21aa91c140f3f5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2d62f1bc03c8432da952077de168498a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f519fd9e57c144e8a7ba65b80b683cf8", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a43e0344b1774a9f8f4b8c5bfc8aae09", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "866b4e7c48ff44b48ed81dcb7930d9a8", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "8832721dc25645d1880a16a8d0f122a9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "fd553396c52242018d5e6e7d5efdc9e5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c1e773ec310f440abd1f91b586ae2934", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a31642e0df3945aa83c2d6084aff0400", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6212c3a95ad14a979a6d58cc416962f5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0652e7bd43094f0bb4ec7c2446c81049", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:32:41,441] Trial 6 finished with value: 11.030189514160156 and parameters: {&#39;input_size&#39;: 12, &#39;learning_rate&#39;: 0.00010700774028059976, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 17}. Best is trial 5 with value: 6.452488422393799.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 6
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 156    | train
5 | linear_season | Linear        | 156    | train
--------------------------------------------------------
312       Trainable params
0         Non-trainable params
312       Total params
0.001     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5a9df93d5b024269bfc96d14912959fb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6aec95e2c1ee46949c666843bab30769", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9792ac2f6b0542778b7489f0b8012df8", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cdad25cb3b984b928c2d3841cb32beb0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "95df850a189c482f9748b544842a8e9b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b1f772b29b7f45ea833ed73829efc4b8", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "830c64811a9648a3a66a7bc7d170a70b", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:32:46,806] Trial 7 finished with value: 10.450048446655273 and parameters: {&#39;input_size&#39;: 12, &#39;learning_rate&#39;: 0.0010618114572205476, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 6}. Best is trial 5 with value: 6.452488422393799.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 9
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 588    | train
5 | linear_season | Linear        | 588    | train
--------------------------------------------------------
1.2 K     Trainable params
0         Non-trainable params
1.2 K     Total params
0.005     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e53dd033b7854d10b1d9a12ccba15dc5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1400a6f0f6e04b6bb43a66545318214c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d5dc503959594b4da9a97ee308f58e9c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "df443bd49f294f76af86e36108899251", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ca84a6efdc8f4ae98b4e8b686bccfcf6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "80634b8bd2c74b059fb8277af4c31076", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "49fbb6074fca4642bd27208543bd7303", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:32:51,463] Trial 8 finished with value: 9.406831741333008 and parameters: {&#39;input_size&#39;: 48, &#39;learning_rate&#39;: 0.0042231254340573, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 9}. Best is trial 5 with value: 6.452488422393799.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 588    | train
5 | linear_season | Linear        | 588    | train
--------------------------------------------------------
1.2 K     Trainable params
0         Non-trainable params
1.2 K     Total params
0.005     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a77ff665c4904823a8e99c632f5190da", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ad40de598b0e4ddfa3ef219aea915015", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5c98b0969d8747fca886cadca13b8d2a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "07021ddd142e416bbc21d86c76f59387", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "45186dcf2a524cc3a16f11d88b10d61d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c2434e4a99e0417ea75a723fc71bbc32", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bd49051fe4ee460ab137baa0fbf66003", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c8ed84709019463dabb82f40082e99ce", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "24e1b4f94b90455e997c0a87eb0db977", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5b6945227f694aff8f0f8d83072f8e74", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6454be52cd8642b4b75d3091cc259ba2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9cacc716638945818b4e4b302e0bdb23", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:33:00,731] Trial 9 finished with value: 9.513204574584961 and parameters: {&#39;input_size&#39;: 48, &#39;learning_rate&#39;: 0.0018985254046270299, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 1}. Best is trial 5 with value: 6.452488422393799.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 16
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 300    | train
5 | linear_season | Linear        | 300    | train
--------------------------------------------------------
600       Trainable params
0         Non-trainable params
600       Total params
0.002     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4acc43156f694d4283c27c2194e9f4a6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f2b44217e172434a805969699e8f91b2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "78306c62515b419ab5b2a878b140ffc4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a7e22f98e1454a85a064ecf79e15fb23", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d3d474ab501f4e88b78dc83fc5b693f2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "19c2cc5632194a6c93f5a19f7e583164", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "29c4ff9a1bc64c608992cecf6fee8c8d", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:33:05,454] Trial 10 finished with value: 6.753950595855713 and parameters: {&#39;input_size&#39;: 24, &#39;learning_rate&#39;: 0.009000086100239928, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 16}. Best is trial 5 with value: 6.452488422393799.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 16
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 300    | train
5 | linear_season | Linear        | 300    | train
--------------------------------------------------------
600       Trainable params
0         Non-trainable params
600       Total params
0.002     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "280bbb11c1e848ac83ea729fa8161187", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "144ae6c9365a4380ab4dc67aa58ffae1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d831349cc3284940a7362f84c917ca43", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1a45b66ceace4967892a0ef34eae429a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e253eeba07fd46a7a8d1d3337463dc7a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a2aa0f63a2b34346b6d46dbfbcf9c91d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f0e51a23a72f4dc6ac1fa95af78604b4", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:33:10,715] Trial 11 finished with value: 6.58156156539917 and parameters: {&#39;input_size&#39;: 24, &#39;learning_rate&#39;: 0.009950968794445545, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 16}. Best is trial 5 with value: 6.452488422393799.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 13
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | decomp        | SeriesDecomp  | 0      | train
4 | linear_trend  | Linear        | 300    | train
5 | linear_season | Linear        | 300    | train
--------------------------------------------------------
600       Trainable params
0         Non-trainable params
600       Total params
0.002     Total estimated model params size (MB)
8         Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "64c3c705c4ef40f5aed98124e99ac657", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d12b7c80dbf44935b87a30b28e054c97", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2993c24a94f1479dba45f61b675bd154", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "65407eb8592e4e66bbb330cec2f6977f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "feba50b2486d46cf95b3081294cc1534", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "020382fdcd754f7b92cddcccca66ff37", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3682f05a3aa94a6bb696eaf52b12830a", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:33:15,744] A new study created in memory with name: no-name-db8fc888-eeec-4d0d-89a8-c3fbe712cafa
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 20
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 384    | train
4 | dec_embedding | DataEmbedding | 384    | train
5 | encoder       | TransEncoder  | 150 K  | train
6 | decoder       | TransDecoder  | 141 K  | train
--------------------------------------------------------
292 K     Trainable params
0         Non-trainable params
292 K     Total params
1.170     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "aa79f3f3fcf74133a057be7f9f3c9837", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9f2244c64e9f4a2dad49ff849821c8aa", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c29854850bd34d2abb49e5428f99e623", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5c16d567606e4643aaef385282774450", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f983eb177d4e48edb2bdbf445a9bd06b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "20eb911f0a324bdf97be18e54b95f5e1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "953872e5332c4cedbe0ba02027cd3aae", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:33:37,033] Trial 0 finished with value: 10.18932056427002 and parameters: {&#39;input_size&#39;: 12, &#39;hidden_size&#39;: 128, &#39;n_head&#39;: 4, &#39;learning_rate&#39;: 0.0014204958993935463, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 20}. Best is trial 0 with value: 10.18932056427002.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 15
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 384    | train
4 | dec_embedding | DataEmbedding | 384    | train
5 | encoder       | TransEncoder  | 150 K  | train
6 | decoder       | TransDecoder  | 141 K  | train
--------------------------------------------------------
292 K     Trainable params
0         Non-trainable params
292 K     Total params
1.170     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a6e4f789054943cdb91a272c56956288", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "341d44f941a64c73893774cfda183956", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d68242e08456409faaffda207ca9241c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "531afa000f48453694fbaa8f53af3708", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6d07d0baa87c4a039db924864b2113f2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e6838a5ba38a4f5493f485e4dc2cc4db", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d80ce6d104d74946a327e7a2b499c6de", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:34:03,089] Trial 1 finished with value: 26.317352294921875 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 128, &#39;n_head&#39;: 4, &#39;learning_rate&#39;: 0.0008347143421695235, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 15}. Best is trial 0 with value: 10.18932056427002.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 5
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 384    | train
4 | dec_embedding | DataEmbedding | 384    | train
5 | encoder       | TransEncoder  | 150 K  | train
6 | decoder       | TransDecoder  | 141 K  | train
--------------------------------------------------------
292 K     Trainable params
0         Non-trainable params
292 K     Total params
1.170     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b857a7afadc14aa8a9f3c3ebce08080b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3f3698a54ea44a40ae9dee685e3d22f7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a4f5560109a6426c962899381cc73070", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "814ee4fced494d4982f3d4bf3584e31d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bca34e8ff5fb48528dcd1d3df44b29a1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "faa6aaa3f71f4a4a946e056cc8e1287d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a83641ffd77043e2835f2d2742d711dd", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9cf3c8b9856747199df45f15168548ea", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9af7484ecfd54b7d99acfa9ea9f995cf", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7e6393497c024284ba102cea9e354689", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "8b413087a5284a988378f1adf7ccc897", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c82f4c6894214996901567042acdd689", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:35:00,014] Trial 2 finished with value: 8.617012023925781 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 128, &#39;n_head&#39;: 8, &#39;learning_rate&#39;: 0.0008564906619894466, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 5}. Best is trial 2 with value: 8.617012023925781.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 7
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 768    | train
4 | dec_embedding | DataEmbedding | 768    | train
5 | encoder       | TransEncoder  | 562 K  | train
6 | decoder       | TransDecoder  | 545 K  | train
--------------------------------------------------------
1.1 M     Trainable params
0         Non-trainable params
1.1 M     Total params
4.436     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "47856acb87b34ad792366e313753fa65", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "4d8d71b1660342d9893f3aafd2dc9746", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ed0ab44e147f470885a3b86a6629434f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6757d0b3fc7746a5b330aae340614e93", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "53846105fe4d478cb5fb9d439d31973c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7e0955d4b22c4eafa9e22503ec4367e1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6ab348c8aeeb49d7965a37f1076ca8f8", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:35:34,505] Trial 3 finished with value: 19.098648071289062 and parameters: {&#39;input_size&#39;: 12, &#39;hidden_size&#39;: 256, &#39;n_head&#39;: 4, &#39;learning_rate&#39;: 0.00015164095258739005, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 7}. Best is trial 2 with value: 8.617012023925781.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 7
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 192    | train
4 | dec_embedding | DataEmbedding | 192    | train
5 | encoder       | TransEncoder  | 42.3 K | train
6 | decoder       | TransDecoder  | 38.0 K | train
--------------------------------------------------------
80.7 K    Trainable params
0         Non-trainable params
80.7 K    Total params
0.323     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ec8ec1252a64d0aaabed02fe0f45790", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "39dea1a246454d498698f697df11d7c5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "a0cb012a4f6f4de48f43d3868cf116e7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e57ceb05dc8e4b678b6197fe2996c385", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3de8b890bd024c1f9616f453f48410a4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ee1e19e496254998b34b2e871567b8ed", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "dac6caf70fb04b1699e7ebc483127109", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:35:49,872] Trial 4 finished with value: 17.39385414123535 and parameters: {&#39;input_size&#39;: 12, &#39;hidden_size&#39;: 64, &#39;n_head&#39;: 4, &#39;learning_rate&#39;: 0.0018907692662973805, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 7}. Best is trial 2 with value: 8.617012023925781.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 17
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 768    | train
4 | dec_embedding | DataEmbedding | 768    | train
5 | encoder       | TransEncoder  | 562 K  | train
6 | decoder       | TransDecoder  | 545 K  | train
--------------------------------------------------------
1.1 M     Trainable params
0         Non-trainable params
1.1 M     Total params
4.436     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "567d921689d240778f46b53d47071e04", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5d7006a52e7944ec86d14a1f64571a0f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9acbae0220894c759a99840b2211a7d1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cc4b3271b73f49d3915aa44b21b0f4d7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "492a8d3213c241d99ed4b8b02372100a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7c9e4e79f1f8493d97532b1733988cab", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0bae3a3447364cde89ac1b292365af2c", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:36:25,266] Trial 5 finished with value: 10.582259178161621 and parameters: {&#39;input_size&#39;: 12, &#39;hidden_size&#39;: 256, &#39;n_head&#39;: 8, &#39;learning_rate&#39;: 0.0003121322610891499, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 17}. Best is trial 2 with value: 8.617012023925781.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 9
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 384    | train
4 | dec_embedding | DataEmbedding | 384    | train
5 | encoder       | TransEncoder  | 150 K  | train
6 | decoder       | TransDecoder  | 141 K  | train
--------------------------------------------------------
292 K     Trainable params
0         Non-trainable params
292 K     Total params
1.170     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "09f9b274e1e34eafbf8fe6dc08b5cbfb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ecdb70f611fd4fe1bcb478ad1f2917fe", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ac0ac66a45c24bdaad29f43fe74f0a08", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f6a25d9b09354263aef38f4223b131cb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "faf9c0b1448241e2b733ce0eb5ce4b95", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7d9a50b0fde74aa5ae295002e69ee1cb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "482288af1e894476bee326e7afa7f53f", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:36:53,516] Trial 6 finished with value: 6.907460689544678 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 128, &#39;n_head&#39;: 8, &#39;learning_rate&#39;: 0.0007269477058819128, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 9}. Best is trial 6 with value: 6.907460689544678.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 3
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 768    | train
4 | dec_embedding | DataEmbedding | 768    | train
5 | encoder       | TransEncoder  | 562 K  | train
6 | decoder       | TransDecoder  | 545 K  | train
--------------------------------------------------------
1.1 M     Trainable params
0         Non-trainable params
1.1 M     Total params
4.436     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "255e2f7c6a8d4d68983752e7dbf02cfc", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7cfad70918fa4284b2733c0e64465af1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ac6368df77cb4fb99f236209a2673c20", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "488ceeea5df6459ba48248d93d048ab5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "8ea949092389419d9ce58a88fb8e5c59", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0e3c9041310145b58382f25baa76525d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "82931c95afdc4429a22d6e9bc1d4ae2f", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:37:45,344] Trial 7 finished with value: 13.060236930847168 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 256, &#39;n_head&#39;: 8, &#39;learning_rate&#39;: 0.007624735540856785, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 3}. Best is trial 6 with value: 6.907460689544678.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 3
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 192    | train
4 | dec_embedding | DataEmbedding | 192    | train
5 | encoder       | TransEncoder  | 42.3 K | train
6 | decoder       | TransDecoder  | 38.0 K | train
--------------------------------------------------------
80.7 K    Trainable params
0         Non-trainable params
80.7 K    Total params
0.323     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d372fa42ffc6413cbaa8bce395d88121", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "233d1d31fe554cb1a3727cdd292cebbe", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "98e9f2b13b8146468cb21718c2c5042a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "daef8471c0b541fcb8fe4ba44a4ab494", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "19fc78b59ac74bc7988cfa12214ab9f8", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "baeec29ee6ad46fbab6eb20827e270b9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ae6daa619ca843cbad47b2675cd6d813", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cba7f7e0d4024528862df653e5a36757", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6a869c1f071342ae888e0af5a9c287d4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "4f15e538c96e40549c72f6614f88eacf", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d99fd97163d54f8e8bcacad72f5b116a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5de6e6e31c6f4af8821fc304d120b48b", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:38:24,195] Trial 8 finished with value: 9.826408386230469 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 64, &#39;n_head&#39;: 4, &#39;learning_rate&#39;: 0.00228553748045075, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 3}. Best is trial 6 with value: 6.907460689544678.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 768    | train
4 | dec_embedding | DataEmbedding | 768    | train
5 | encoder       | TransEncoder  | 562 K  | train
6 | decoder       | TransDecoder  | 545 K  | train
--------------------------------------------------------
1.1 M     Trainable params
0         Non-trainable params
1.1 M     Total params
4.436     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d5a3c782991c4cd9a951e5440d816e58", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3ac9e34ef8224e3a87b5ab244ce6016b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "130fa500d3a04685b549af582cd29674", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "50b2d8cbd58d4a6dbe58d50519c0ca29", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "54d0bffdc2ce429cb63ece7642474103", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "325aaa7f56d44141b5ad3d2d018c2a0c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3ab76d1d92b94296999d0fa05abde16f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "05d2e3317fa64c499192bc717ffc00ac", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f9663d8bdcd5447b9dc9da1263ec29d6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e6145e77840d4a6691a6748f4be9036f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "422cde67392a4b6ab388758a681c1f59", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9f68d39a23df4077b986770e3a0987d7", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:40:18,704] Trial 9 finished with value: 23.377031326293945 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 256, &#39;n_head&#39;: 4, &#39;learning_rate&#39;: 0.0031209590192875724, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 10}. Best is trial 6 with value: 6.907460689544678.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 12
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 384    | train
4 | dec_embedding | DataEmbedding | 384    | train
5 | encoder       | TransEncoder  | 150 K  | train
6 | decoder       | TransDecoder  | 141 K  | train
--------------------------------------------------------
292 K     Trainable params
0         Non-trainable params
292 K     Total params
1.170     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9630ed8fc28d4f159a7fa997cbb18557", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9b1e06b35ba7420194b8a8d0b4022fe5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "84f6a3fed79a41b9946224e5d964f870", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "14d1cfbd67ad4dc39e46938ff7b7b85d", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f1195d97c7b8419f9703f81ce090214a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b1eb1fa8bd254645babb76843da39d05", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "eb6638e9c13f4b978c0f043d1bc876df", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "282026c8e6034a43b9fcc3bd65e7541e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c69188bcccb94aa39f2a9ced6b9aced9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2751bd3575ae4a7a82e9f72a63604c66", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bc3448057feb4167a1a7f959b5a9acc0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6449e83bf95c4957a05eb38543fd1ce2", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:42:37,648] Trial 10 finished with value: 7.007484436035156 and parameters: {&#39;input_size&#39;: 48, &#39;hidden_size&#39;: 128, &#39;n_head&#39;: 8, &#39;learning_rate&#39;: 0.0003501485073778288, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 12}. Best is trial 6 with value: 6.907460689544678.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 12
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 384    | train
4 | dec_embedding | DataEmbedding | 384    | train
5 | encoder       | TransEncoder  | 150 K  | train
6 | decoder       | TransDecoder  | 141 K  | train
--------------------------------------------------------
292 K     Trainable params
0         Non-trainable params
292 K     Total params
1.170     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "22442c57857642728eeb8f31f02497c3", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "29e8451df20f41acbe34527da3c09e5f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "da5cb9e887a1425389688761a7d7978a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6f8f9c0c32f246b4891639eb038b74db", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cf953647ba92473da09eb46cbb2f72ee", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "26b890342b0b47bf909ba16a1d71dfe0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "df730e9d8c14474592d06ba86af1117b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "8d38ce92f35441d09c39e1caf9b20d6b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "8df5383d0bbe416f8684b3f1b05f7710", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "16125ca78f9742c0b95ec077f16c6496", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e03db4def97d460fbbdcc7b702980ade", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0f1f953ad2e548898318d5a1bb3c40b5", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:44:51,596] Trial 11 finished with value: 7.1937994956970215 and parameters: {&#39;input_size&#39;: 48, &#39;hidden_size&#39;: 128, &#39;n_head&#39;: 8, &#39;learning_rate&#39;: 0.00035255016194765914, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 12}. Best is trial 6 with value: 6.907460689544678.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 9
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name          | Type          | Params | Mode 
--------------------------------------------------------
0 | loss          | MAE           | 0      | train
1 | padder_train  | ConstantPad1d | 0      | train
2 | scaler        | TemporalNorm  | 0      | train
3 | enc_embedding | DataEmbedding | 384    | train
4 | dec_embedding | DataEmbedding | 384    | train
5 | encoder       | TransEncoder  | 150 K  | train
6 | decoder       | TransDecoder  | 141 K  | train
--------------------------------------------------------
292 K     Trainable params
0         Non-trainable params
292 K     Total params
1.170     Total estimated model params size (MB)
67        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ab99245ed6214e44b799daa12d62d379", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d9fd81d0df6f4dd3a731d00bb8f51b76", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c4b19782f3f94c4cb92a57d1f976e460", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "68e84a06647e4534939273290edf8a4c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b4938584baf4421fa89f7667341bebc3", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "aaa4eb8336cb45c7a1e92cb15a3347c1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9b3f59a340da4eb08991ba23c4bc721a", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:45:23,706] A new study created in memory with name: no-name-2c8275fc-5dbf-471c-bc1b-f85824ae52e0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 3
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 79.1 K | train
4 | dense_decoder    | Sequential    | 164 K  | train
5 | temporal_decoder | MLPResidual   | 2.3 K  | train
6 | global_skip      | Linear        | 300    | train
-----------------------------------------------------------
246 K     Trainable params
0         Non-trainable params
246 K     Total params
0.986     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5e1c36807d0f482d88b75c77b3a12839", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c2853640abba46088756212396fb230a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "368b6350f996458dbaa9f189d89e9d91", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bda65e529f9a4799ae1351d3a1719cd5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "2f7b802c4f6e462e9d269d110eca9763", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "88cf383ddb1042e98486e287be8d0189", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "42ff18cabd0c47e4aaa172bb0e337f44", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:45:31,322] Trial 0 finished with value: 5.30569314956665 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 256, &#39;decoder_output_dim&#39;: 16, &#39;temporal_decoder_dim&#39;: 128, &#39;dropout&#39;: 0.16208029002518637, &#39;learning_rate&#39;: 0.0006300140869339265, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 3}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 13
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 289 K  | train
4 | dense_decoder    | Sequential    | 1.1 M  | train
5 | temporal_decoder | MLPResidual   | 8.5 K  | train
6 | global_skip      | Linear        | 300    | train
-----------------------------------------------------------
1.4 M     Trainable params
0         Non-trainable params
1.4 M     Total params
5.401     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9d7ca65928e549e981da1cf3cefa5fa2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "fb8aeb53ff49457fb0dfdc0cd7608ed0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "59c9aad8ceae4995ac07b7433dc9aa0c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "32c7037d043045649a04f2808fae5899", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "9e2148f7e5154c43bfd70816c5e5c733", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b38fd30addb041219dc4ee968cb3078c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c7d74954b3ad41648fc2535db5e621e6", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:45:40,692] Trial 1 finished with value: 6.4255805015563965 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 512, &#39;decoder_output_dim&#39;: 64, &#39;temporal_decoder_dim&#39;: 128, &#39;dropout&#39;: 0.26160501718677565, &#39;learning_rate&#39;: 0.006805508835921361, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 13}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 313 K  | train
4 | dense_decoder    | Sequential    | 460 K  | train
5 | temporal_decoder | MLPResidual   | 2.3 K  | train
6 | global_skip      | Linear        | 588    | train
-----------------------------------------------------------
776 K     Trainable params
0         Non-trainable params
776 K     Total params
3.107     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "afede4cfe85b495caa3370d3e3e4ad54", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d706c60dc3bb4c8a8f6a0c90104624ac", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f31602c5c1c94b2c8fb1fb11451c356b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c9b98c80b29947a8a63468ecf53c5db4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ce06f8289595444b8c5261143f137886", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "73e73945fe204106a5618e81ec2fb7bf", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "73e44af54dd04e59aea80af893aa6dc5", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:45:49,220] Trial 2 finished with value: 6.669483184814453 and parameters: {&#39;input_size&#39;: 48, &#39;hidden_size&#39;: 512, &#39;decoder_output_dim&#39;: 16, &#39;temporal_decoder_dim&#39;: 128, &#39;dropout&#39;: 0.26051517716148676, &#39;learning_rate&#39;: 0.00011188442159051253, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 4}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 9
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 73.0 K | train
4 | dense_decoder    | Sequential    | 462 K  | train
5 | temporal_decoder | MLPResidual   | 4.3 K  | train
6 | global_skip      | Linear        | 156    | train
-----------------------------------------------------------
539 K     Trainable params
0         Non-trainable params
539 K     Total params
2.158     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2e165793f99d434181832e7330ade14f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d0308c3fba8a410ca6ea0dce56074eb0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e4aad456544f470682a7a3162a279a13", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "989de2165ace4972926862dfbbd84d71", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "748c5896adba484ab0b1c2939fb2fb0a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "97f5214ecc384da49e44a2731226576f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1a2918041b6b4324875c125a53938e28", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:45:57,326] Trial 3 finished with value: 10.548564910888672 and parameters: {&#39;input_size&#39;: 12, &#39;hidden_size&#39;: 256, &#39;decoder_output_dim&#39;: 64, &#39;temporal_decoder_dim&#39;: 64, &#39;dropout&#39;: 0.4805845768680371, &#39;learning_rate&#39;: 0.008143071027773546, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 9}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 15
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 79.1 K | train
4 | dense_decoder    | Sequential    | 263 K  | train
5 | temporal_decoder | MLPResidual   | 2.2 K  | train
6 | global_skip      | Linear        | 300    | train
-----------------------------------------------------------
345 K     Trainable params
0         Non-trainable params
345 K     Total params
1.382     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d51124f61528494a8d9ef90db352e139", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e03752622330485d83f00608d6600356", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0989a518448e44ca8bdb2516c3b3930a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bbc91ad9d0cd4bf0be3862dbec6350a6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "680e048437ab47a58a7b6ac1291ea244", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0de1ad25abea4a6587c87cd0a9f07897", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bc175e8dc39b47859d183f1a6d1b7bda", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:46:04,922] Trial 4 finished with value: 7.342437744140625 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 256, &#39;decoder_output_dim&#39;: 32, &#39;temporal_decoder_dim&#39;: 64, &#39;dropout&#39;: 0.21336425116013236, &#39;learning_rate&#39;: 0.00041174204682962166, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 15}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 276 K  | train
4 | dense_decoder    | Sequential    | 657 K  | train
5 | temporal_decoder | MLPResidual   | 2.2 K  | train
6 | global_skip      | Linear        | 156    | train
-----------------------------------------------------------
936 K     Trainable params
0         Non-trainable params
936 K     Total params
3.747     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e4574dba55d64a0cafc5251bb25aeedc", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "0a4272be3c814ae2b5b9b72b8caaf7da", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "18fe081fa05a49c1b5f3bd3f0798bd39", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "90e21206dee946639a6cdffb597d091a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "44719508d6a145e7a3c7015bb72f2bcb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f0842f5b617f4ffebf5ceb6613cab203", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e1584948e260449cacde51f3245093b7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "bd426e03bb044c92ae7cee4390e72100", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "51f0bcd0797843f6abb6e5dc6c9439f3", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d94c3438504247b3b337671f736b537b", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e939ac9628a7446dac588d245534a451", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e4920b19682745dc929159485d552856", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:46:22,284] Trial 5 finished with value: 7.773954391479492 and parameters: {&#39;input_size&#39;: 12, &#39;hidden_size&#39;: 512, &#39;decoder_output_dim&#39;: 32, &#39;temporal_decoder_dim&#39;: 64, &#39;dropout&#39;: 0.2743589669375161, &#39;learning_rate&#39;: 0.0001683128854820381, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 10}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 20
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 276 K  | train
4 | dense_decoder    | Sequential    | 1.1 M  | train
5 | temporal_decoder | MLPResidual   | 4.3 K  | train
6 | global_skip      | Linear        | 156    | train
-----------------------------------------------------------
1.3 M     Trainable params
0         Non-trainable params
1.3 M     Total params
5.334     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a161e3414e3e452baa037e900f9774c0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "55da4df0ce7049289c8ad3e53d29e9f6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "212b7f40972e4cdeb00853802f7bf9b1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1dd4e2b2873c4d1d872355602346bf91", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "57faae96b3cb407b987828daeeec7896", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "df7ff4ddfac2455bbd183ca07e9541cf", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "451a9b34b0b142769f8633acc676ceec", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:46:31,843] Trial 6 finished with value: 12.221308708190918 and parameters: {&#39;input_size&#39;: 12, &#39;hidden_size&#39;: 512, &#39;decoder_output_dim&#39;: 64, &#39;temporal_decoder_dim&#39;: 64, &#39;dropout&#39;: 0.1907455370076404, &#39;learning_rate&#39;: 0.00012241255920067992, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 20}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 19
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 79.1 K | train
4 | dense_decoder    | Sequential    | 263 K  | train
5 | temporal_decoder | MLPResidual   | 4.4 K  | train
6 | global_skip      | Linear        | 300    | train
-----------------------------------------------------------
347 K     Trainable params
0         Non-trainable params
347 K     Total params
1.391     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "de88cb18c5ac4544960ccb59a9ef8f02", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "df2fa9f8f5d044e2a777cb3897d64d1a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "4eba1165025e4d4b976b05b67d3c849a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "fd397ba40615452b9cde3a9160fe1ee2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ffd9f704c91748bcb033bccd3dc69549", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cc71dd6237884e599b5869b7e65928bf", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cb09e6f6d4044286b7f1abfad8182a1d", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:46:39,422] Trial 7 finished with value: 5.552103042602539 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 256, &#39;decoder_output_dim&#39;: 32, &#39;temporal_decoder_dim&#39;: 128, &#39;dropout&#39;: 0.2685779298575292, &#39;learning_rate&#39;: 0.00038864355830132107, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 19}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 15
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 276 K  | train
4 | dense_decoder    | Sequential    | 1.1 M  | train
5 | temporal_decoder | MLPResidual   | 4.3 K  | train
6 | global_skip      | Linear        | 156    | train
-----------------------------------------------------------
1.3 M     Trainable params
0         Non-trainable params
1.3 M     Total params
5.334     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7a359617927a42e08209df1fd0fdf7d7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "65de1e8847fa42f2bdd9b6a2b55b1884", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e71df5a43dbe4d6eaac2d003843ad3ef", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cc1e0d1d60c4493aa9e9c318383e91a2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "4090f650b67e4d4da328a8b734342ab4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "83cd502bf32947199cb448d3d47f3ccf", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "cc7623d9ff174d0580ad9d9b29895ecf", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:46:49,157] Trial 8 finished with value: 11.073525428771973 and parameters: {&#39;input_size&#39;: 12, &#39;hidden_size&#39;: 512, &#39;decoder_output_dim&#39;: 64, &#39;temporal_decoder_dim&#39;: 64, &#39;dropout&#39;: 0.21456008744795643, &#39;learning_rate&#39;: 0.009296447650090366, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 15}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 91.4 K | train
4 | dense_decoder    | Sequential    | 164 K  | train
5 | temporal_decoder | MLPResidual   | 1.2 K  | train
6 | global_skip      | Linear        | 588    | train
-----------------------------------------------------------
258 K     Trainable params
0         Non-trainable params
258 K     Total params
1.032     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4b9666d349f94c7584a6a90ba75c03fb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "fb768ca3540d45079c74bb30cf608a50", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "da464ee14cfb49b9865d1a29c951fc07", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c456d05b93224d99894a06521e0dac1a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "72fa22ed80644a2ebf5fe6e955e7aa32", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "30235eac83be4271b97b094ac2b9c8a4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d9b7bbd3268f4ad3a4c905a8d2b10b0c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1fe0b74d8c424282a06db994806a9203", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ccfbf74c75a64f03a03bc5181349ba2a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "38bc429bdf734c01ba6bc03cd01f915a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d38b394c10a94264b1b8d49a6231a187", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "350843246d4f457cb8b36c6c6c9900b3", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:47:04,029] Trial 9 finished with value: 9.240368843078613 and parameters: {&#39;input_size&#39;: 48, &#39;hidden_size&#39;: 256, &#39;decoder_output_dim&#39;: 16, &#39;temporal_decoder_dim&#39;: 64, &#39;dropout&#39;: 0.14444427790941053, &#39;learning_rate&#39;: 0.0032156952159734906, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 10}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 3
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 79.1 K | train
4 | dense_decoder    | Sequential    | 164 K  | train
5 | temporal_decoder | MLPResidual   | 2.3 K  | train
6 | global_skip      | Linear        | 300    | train
-----------------------------------------------------------
246 K     Trainable params
0         Non-trainable params
246 K     Total params
0.986     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d03ec411515c4983a682cd629237d89a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "755dbbb3096a45b5b8a5b057b7dc4aad", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "23cf6331299844b7bcb22a6a8bff090c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "68dd0c1f393b4c698402ddc202ad0465", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f444258fa27a4e7ab7ba0aa6642ecec2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b52ec85bd79044cba7b52e72f4354c6f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ffd5a453a2d5422babe2d1299c570576", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "31e9e9f13b104a5193bc307230b9c7cb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1b185dc5a5e94df3a9ecb860d10973ba", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7dd53d3e2b324f939664fd9b62a105d7", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "96bbcbffed0447deb516993f88257d42", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "af7713e694df44679c223c680b025d85", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=1000` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:47:18,866] Trial 10 finished with value: 6.390902042388916 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 256, &#39;decoder_output_dim&#39;: 16, &#39;temporal_decoder_dim&#39;: 128, &#39;dropout&#39;: 0.38611842545887776, &#39;learning_rate&#39;: 0.0013519714213350174, &#39;max_steps&#39;: 1000, &#39;batch_size&#39;: 32, &#39;random_seed&#39;: 3}. Best is trial 0 with value: 5.30569314956665.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 20
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 79.1 K | train
4 | dense_decoder    | Sequential    | 263 K  | train
5 | temporal_decoder | MLPResidual   | 4.4 K  | train
6 | global_skip      | Linear        | 300    | train
-----------------------------------------------------------
347 K     Trainable params
0         Non-trainable params
347 K     Total params
1.391     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "11f0055984554150a1aae5e6aa2d4f33", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "473683667f234b8baf1e3dd95f5b993f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b9d995c3d83a404ca3ee2066a918aa3a", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "1df228f632424f3d9f7c7c4a5fcf30e0", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e4e32552c13b4a7a81ee914eddbf22a5", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "24f701083b064e20bd6fa69abf378b17", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3aa2a3443277455dab9cac3965b42b75", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-10-01 11:47:26,404] Trial 11 finished with value: 4.314075469970703 and parameters: {&#39;input_size&#39;: 24, &#39;hidden_size&#39;: 256, &#39;decoder_output_dim&#39;: 32, &#39;temporal_decoder_dim&#39;: 128, &#39;dropout&#39;: 0.10066541529976752, &#39;learning_rate&#39;: 0.00046271251937444053, &#39;max_steps&#39;: 500, &#39;batch_size&#39;: 64, &#39;random_seed&#39;: 20}. Best is trial 11 with value: 4.314075469970703.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seed set to 20
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name             | Type          | Params | Mode 
-----------------------------------------------------------
0 | loss             | MAE           | 0      | train
1 | padder_train     | ConstantPad1d | 0      | train
2 | scaler           | TemporalNorm  | 0      | train
3 | dense_encoder    | Sequential    | 79.1 K | train
4 | dense_decoder    | Sequential    | 263 K  | train
5 | temporal_decoder | MLPResidual   | 4.4 K  | train
6 | global_skip      | Linear        | 300    | train
-----------------------------------------------------------
347 K     Trainable params
0         Non-trainable params
347 K     Total params
1.391     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dffad805711848b98ff2eb6246666ec9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "3f0ca44acf80473d9ae26ecc03986e5c", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "32a742ae4f974b6d893917c63c1f29fb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b8dada556477435882da46a5fa765ff2", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "5ccd35c0c5f742329946157678985997", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "53fc0a1d402e4a74bb03970540a4c624", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "b4a23de448df4a00a2702bd81fa2e512", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_steps=500` reached.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "067e00b426994bc496937ce45bd645b8", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d0e722e21ba54e118914569b29e96713", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b9882b9c3f1c47f1bcba5d9a9f74fad0", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: True (mps), used: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3ae8a79a50f14804a0f18fa466ad7eab", "version_major": 2, "version_minor": 0}</script><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_id</th>
      <th>ds</th>
      <th>DeepAR</th>
      <th>DeepAR-median</th>
      <th>DeepAR-lo-90</th>
      <th>DeepAR-lo-80</th>
      <th>DeepAR-hi-80</th>
      <th>DeepAR-hi-90</th>
      <th>DLinear</th>
      <th>Transformer</th>
      <th>TiDE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>arb_2</td>
      <td>2024-06-28</td>
      <td>20.243612</td>
      <td>20.468487</td>
      <td>16.923187</td>
      <td>17.852261</td>
      <td>22.654491</td>
      <td>23.129183</td>
      <td>23.996090</td>
      <td>35.356022</td>
      <td>21.586510</td>
    </tr>
    <tr>
      <th>1</th>
      <td>arb_2</td>
      <td>2024-07-31</td>
      <td>26.473684</td>
      <td>26.231861</td>
      <td>23.106380</td>
      <td>23.473431</td>
      <td>28.250650</td>
      <td>28.939981</td>
      <td>25.895927</td>
      <td>38.882614</td>
      <td>29.003674</td>
    </tr>
    <tr>
      <th>2</th>
      <td>arb_2</td>
      <td>2024-08-30</td>
      <td>30.809818</td>
      <td>30.904499</td>
      <td>28.113544</td>
      <td>29.056847</td>
      <td>32.686378</td>
      <td>33.578949</td>
      <td>34.498146</td>
      <td>37.175640</td>
      <td>34.187576</td>
    </tr>
    <tr>
      <th>3</th>
      <td>arb_2</td>
      <td>2024-09-30</td>
      <td>29.738501</td>
      <td>30.027279</td>
      <td>27.104456</td>
      <td>27.585302</td>
      <td>32.429165</td>
      <td>33.153923</td>
      <td>36.453121</td>
      <td>35.741730</td>
      <td>36.503365</td>
    </tr>
    <tr>
      <th>4</th>
      <td>arb_2</td>
      <td>2024-10-31</td>
      <td>29.702717</td>
      <td>29.347023</td>
      <td>27.023962</td>
      <td>27.302546</td>
      <td>31.796762</td>
      <td>32.777470</td>
      <td>30.273775</td>
      <td>36.565559</td>
      <td>29.112751</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="combine-forecasts-across-all-models">
<h2>Combine Forecasts Across All Models<a class="headerlink" href="#combine-forecasts-across-all-models" title="Link to this heading">#</a></h2>
<p>Merge the statistical and neural forecasts so downstream evaluation considers
the full model roster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">combined_forecasts_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">stats_forecasts_df</span><span class="p">,</span>
    <span class="n">neural_forecasts_df</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;unique_id&quot;</span><span class="p">,</span> <span class="s2">&quot;ds&quot;</span><span class="p">],</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">combined_forecasts_df</span> <span class="o">=</span> <span class="n">combined_forecasts_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;unique_id&quot;</span><span class="p">,</span> <span class="s2">&quot;ds&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">combined_forecasts_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_id</th>
      <th>ds</th>
      <th>HistAvg</th>
      <th>HistAvg-lo-90</th>
      <th>HistAvg-hi-90</th>
      <th>ARIMA</th>
      <th>ARIMA-lo-90</th>
      <th>ARIMA-hi-90</th>
      <th>Theta</th>
      <th>Theta-lo-90</th>
      <th>Theta-hi-90</th>
      <th>DeepAR</th>
      <th>DeepAR-median</th>
      <th>DeepAR-lo-90</th>
      <th>DeepAR-lo-80</th>
      <th>DeepAR-hi-80</th>
      <th>DeepAR-hi-90</th>
      <th>DLinear</th>
      <th>Transformer</th>
      <th>TiDE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>arb_2</td>
      <td>2024-06-28</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>17.964419</td>
      <td>-6.617129</td>
      <td>42.545967</td>
      <td>24.988881</td>
      <td>-3.406585</td>
      <td>60.804602</td>
      <td>20.243612</td>
      <td>20.468487</td>
      <td>16.923187</td>
      <td>17.852261</td>
      <td>22.654491</td>
      <td>23.129183</td>
      <td>23.996090</td>
      <td>35.356022</td>
      <td>21.586510</td>
    </tr>
    <tr>
      <th>1</th>
      <td>arb_2</td>
      <td>2024-07-31</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>16.558516</td>
      <td>-20.490939</td>
      <td>53.607972</td>
      <td>29.972844</td>
      <td>-12.755830</td>
      <td>74.388970</td>
      <td>26.473684</td>
      <td>26.231861</td>
      <td>23.106380</td>
      <td>23.473431</td>
      <td>28.250650</td>
      <td>28.939981</td>
      <td>25.895927</td>
      <td>38.882614</td>
      <td>29.003674</td>
    </tr>
    <tr>
      <th>2</th>
      <td>arb_2</td>
      <td>2024-08-30</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>17.926385</td>
      <td>-25.047642</td>
      <td>60.900412</td>
      <td>31.051118</td>
      <td>-30.850561</td>
      <td>83.230372</td>
      <td>30.809818</td>
      <td>30.904499</td>
      <td>28.113544</td>
      <td>29.056847</td>
      <td>32.686378</td>
      <td>33.578949</td>
      <td>34.498146</td>
      <td>37.175640</td>
      <td>34.187576</td>
    </tr>
    <tr>
      <th>3</th>
      <td>arb_2</td>
      <td>2024-09-30</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>18.466627</td>
      <td>-29.020012</td>
      <td>65.953265</td>
      <td>32.683670</td>
      <td>-29.449171</td>
      <td>86.350302</td>
      <td>29.738501</td>
      <td>30.027279</td>
      <td>27.104456</td>
      <td>27.585302</td>
      <td>32.429165</td>
      <td>33.153923</td>
      <td>36.453121</td>
      <td>35.741730</td>
      <td>36.503365</td>
    </tr>
    <tr>
      <th>4</th>
      <td>arb_2</td>
      <td>2024-10-31</td>
      <td>24.073318</td>
      <td>-19.360813</td>
      <td>67.507449</td>
      <td>16.652616</td>
      <td>-35.490638</td>
      <td>68.795869</td>
      <td>32.711856</td>
      <td>-31.470616</td>
      <td>97.486275</td>
      <td>29.702717</td>
      <td>29.347023</td>
      <td>27.023962</td>
      <td>27.302546</td>
      <td>31.796762</td>
      <td>32.777470</td>
      <td>30.273775</td>
      <td>36.565559</td>
      <td>29.112751</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="visualize-forecasts-vs-actuals">
<h2>Visualize Forecasts vs Actuals<a class="headerlink" href="#visualize-forecasts-vs-actuals" title="Link to this heading">#</a></h2>
<p>Plot the forecasts from all models against the actual test data.
This helps us see:</p>
<ul class="simple">
<li><p>Which models track the actual movements</p></li>
<li><p>Which models produce realistic prediction intervals</p></li>
<li><p>Which models may be too aggressive or too conservative</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine train and test for plotting</span>
<span class="n">sf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y_df</span><span class="p">,</span> <span class="n">stats_forecasts_df</span><span class="p">,</span> <span class="n">max_insample_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ae54894a5876ba66005ec50804914b35900397664fe01010ae7e743cf6c895b6.png" src="../_images/ae54894a5876ba66005ec50804914b35900397664fe01010ae7e743cf6c895b6.png" />
</div>
</div>
<section id="focus-on-specific-models">
<h3>Focus on Specific Models<a class="headerlink" href="#focus-on-specific-models" title="Link to this heading">#</a></h3>
<p>Letâ€™s compare a few specific models in detail to understand their behavior.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">Y_df</span><span class="p">,</span>
    <span class="n">stats_forecasts_df</span><span class="p">,</span>
    <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HistAvg&quot;</span><span class="p">,</span> <span class="s2">&quot;ARIMA&quot;</span><span class="p">,</span> <span class="s2">&quot;Theta&quot;</span><span class="p">],</span>
    <span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">],</span>
    <span class="n">max_insample_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># # %%  # Commented out - SES model not active</span>
<span class="c1"># sf.plot(</span>
<span class="c1">#     Y_df,</span>
<span class="c1">#     stats_forecasts_df,</span>
<span class="c1">#     models=[&quot;HistAvg&quot;, &quot;SES&quot;, &quot;ARIMA&quot;],</span>
<span class="c1">#     level=[90],</span>
<span class="c1">#     max_insample_length=200,</span>
<span class="c1"># )</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/de87c0b9c9df017072acfd8ad90f017a9d21eb58f82b0b21108b77d94bfe8f43.png" src="../_images/de87c0b9c9df017072acfd8ad90f017a9d21eb58f82b0b21108b77d94bfe8f43.png" />
</div>
</div>
</section>
<section id="visualize-auto-neural-forecasts">
<h3>Visualize Auto Neural Forecasts<a class="headerlink" href="#visualize-auto-neural-forecasts" title="Link to this heading">#</a></h3>
<p>Plot the auto neural predictions alongside the actual test observations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter to only point estimate columns (exclude prediction intervals and quantiles)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_point_estimate</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if column is a point estimate (not a quantile or prediction interval).&quot;&quot;&quot;</span>
    <span class="n">col_lower</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">exclude_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-lo-&quot;</span><span class="p">,</span> <span class="s2">&quot;-hi-&quot;</span><span class="p">,</span> <span class="s2">&quot;-median&quot;</span><span class="p">,</span> <span class="s2">&quot;-quantile&quot;</span><span class="p">,</span> <span class="s2">&quot;quantile-&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">pattern</span> <span class="ow">in</span> <span class="n">col_lower</span> <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">exclude_patterns</span><span class="p">)</span>

<span class="c1"># Get all point estimate columns from both stats and neural forecasts</span>
<span class="c1"># Exclude HistAvg from plotting</span>
<span class="n">all_model_cols</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">combined_forecasts_df</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;unique_id&quot;</span><span class="p">,</span> <span class="s2">&quot;ds&quot;</span><span class="p">,</span> <span class="s2">&quot;HistAvg&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">is_point_estimate</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="p">]</span>

<span class="c1"># Calculate how many months back to show (at least 60 months = 5 years)</span>
<span class="n">lookback_months</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">lookback_idx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y_df</span><span class="p">)</span> <span class="o">-</span> <span class="n">lookback_months</span> <span class="o">-</span> <span class="n">test_size</span><span class="p">)</span>
<span class="n">historical_df</span> <span class="o">=</span> <span class="n">Y_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">lookback_idx</span><span class="p">:]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot historical data (train + test)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">historical_df</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">],</span> <span class="n">historical_df</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Actual&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Plot all model forecasts</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">all_model_cols</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">combined_forecasts_df</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">],</span> <span class="n">combined_forecasts_df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Add vertical line at train/test split</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_df</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast Start&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;All Model Forecasts vs Actuals (Last 5+ Years)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Basis Spread&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_and_show_plot</span><span class="p">(</span><span class="s2">&quot;example_forecasts_all_models.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Saved plot to /Users/jbejarano/GitRepositories/ftsfr/_output/forecasting/paper/example_forecasts_all_models.png
</pre></div>
</div>
<img alt="../_images/c8835e2859e6646ae384c159285df820c9320552f7f9906bdd5eeddb05edbb2a.png" src="../_images/c8835e2859e6646ae384c159285df820c9320552f7f9906bdd5eeddb05edbb2a.png" />
</div>
</div>
</section>
</section>
<section id="cross-validation-for-robust-evaluation-commented-out-for-debugging">
<h2>Cross-Validation for Robust Evaluation (COMMENTED OUT FOR DEBUGGING)<a class="headerlink" href="#cross-validation-for-robust-evaluation-commented-out-for-debugging" title="Link to this heading">#</a></h2>
<p>This section is commented out to speed up debugging.
Uncomment when you want to run full cross-validation analysis.
â€œâ€â€</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1># %%<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id2">
<h1>â€œâ€â€<a class="headerlink" href="#id2" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="instead-of-a-single-train-test-split-well-use-cross-validation-with-multiple">
<h1>Instead of a single train/test split, weâ€™ll use cross-validation with multiple<a class="headerlink" href="#instead-of-a-single-train-test-split-well-use-cross-validation-with-multiple" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="windows-to-get-a-more-robust-assessment-of-model-performance">
<h1>windows to get a more robust assessment of model performance.<a class="headerlink" href="#windows-to-get-a-more-robust-assessment-of-model-performance" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id3">
<h1><a class="headerlink" href="#id3" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="well-use">
<h1>Weâ€™ll use:<a class="headerlink" href="#well-use" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="forecast-horizon-12-months-matching-the-held-out-forecast-horizon">
<h1>- Forecast horizon: 12 months (matching the held-out forecast horizon)<a class="headerlink" href="#forecast-horizon-12-months-matching-the-held-out-forecast-horizon" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="step-size-12-months-non-overlapping-windows">
<h1>- Step size: 12 months (non-overlapping windows)<a class="headerlink" href="#step-size-12-months-non-overlapping-windows" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="up-to-5-windows-limited-by-data-length">
<h1>- Up to 5 windows (limited by data length)<a class="headerlink" href="#up-to-5-windows-limited-by-data-length" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id4">
<h1>â€œâ€â€<a class="headerlink" href="#id4" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id5">
<h1><a class="headerlink" href="#id5" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id6">
<h1># %%<a class="headerlink" href="#id6" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="cv-horizon-forecast-horizon">
<h1>cv_horizon = forecast_horizon<a class="headerlink" href="#cv-horizon-forecast-horizon" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="max-windows-max-1-len-y-df-cv-horizon-1">
<h1>max_windows = max(1, (len(Y_df) // cv_horizon) - 1)<a class="headerlink" href="#max-windows-max-1-len-y-df-cv-horizon-1" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="cv-windows-min-5-max-windows">
<h1>cv_windows = min(5, max_windows)<a class="headerlink" href="#cv-windows-min-5-max-windows" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id7">
<h1><a class="headerlink" href="#id7" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="stats-cv-df-sf-cross-validation">
<h1>stats_cv_df = sf.cross_validation(<a class="headerlink" href="#stats-cv-df-sf-cross-validation" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="df-y-df">
<h1>df=Y_df,<a class="headerlink" href="#df-y-df" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="h-cv-horizon">
<h1>h=cv_horizon,<a class="headerlink" href="#h-cv-horizon" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="step-size-cv-horizon">
<h1>step_size=cv_horizon,<a class="headerlink" href="#step-size-cv-horizon" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="n-windows-cv-windows">
<h1>n_windows=cv_windows,<a class="headerlink" href="#n-windows-cv-windows" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id8">
<h1>)<a class="headerlink" href="#id8" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="stats-cv-df-head">
<h1>stats_cv_df.head()<a class="headerlink" href="#stats-cv-df-head" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id9">
<h1><a class="headerlink" href="#id9" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id10">
<h1># %%<a class="headerlink" href="#id10" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id11">
<h1>â€œâ€â€<a class="headerlink" href="#id11" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="neural-cross-validation">
<h1>### Neural Cross-Validation<a class="headerlink" href="#neural-cross-validation" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id12">
<h1><a class="headerlink" href="#id12" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="refit-the-auto-neural-models-within-the-cross-validation-windows-to-evaluate">
<h1>Refit the auto neural models within the cross-validation windows to evaluate<a class="headerlink" href="#refit-the-auto-neural-models-within-the-cross-validation-windows-to-evaluate" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="their-stability-across-different-training-periods">
<h1>their stability across different training periods.<a class="headerlink" href="#their-stability-across-different-training-periods" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id13">
<h1>â€œâ€â€<a class="headerlink" href="#id13" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id14">
<h1><a class="headerlink" href="#id14" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id15">
<h1># %%<a class="headerlink" href="#id15" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="neural-cv-models-build-auto-neural-models-cv-horizon-auto-logs-dir-cv">
<h1>neural_cv_models = build_auto_neural_models(cv_horizon, auto_logs_dir / â€œcvâ€)<a class="headerlink" href="#neural-cv-models-build-auto-neural-models-cv-horizon-auto-logs-dir-cv" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="nf-cv-neuralforecast-models-neural-cv-models-freq-bme">
<h1>nf_cv = NeuralForecast(models=neural_cv_models, freq=â€œBMEâ€)<a class="headerlink" href="#nf-cv-neuralforecast-models-neural-cv-models-freq-bme" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id16">
<h1><a class="headerlink" href="#id16" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="neural-cv-df-nf-cv-cross-validation">
<h1>neural_cv_df = nf_cv.cross_validation(<a class="headerlink" href="#neural-cv-df-nf-cv-cross-validation" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id17">
<h1>df=Y_df,<a class="headerlink" href="#id17" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id18">
<h1>n_windows=cv_windows,<a class="headerlink" href="#id18" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id19">
<h1>step_size=cv_horizon,<a class="headerlink" href="#id19" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id20">
<h1>)<a class="headerlink" href="#id20" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="neural-cv-df-head">
<h1>neural_cv_df.head()<a class="headerlink" href="#neural-cv-df-head" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id21">
<h1><a class="headerlink" href="#id21" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id22">
<h1># %%<a class="headerlink" href="#id22" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id23">
<h1>â€œâ€â€<a class="headerlink" href="#id23" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="combine-cross-validation-results">
<h1>### Combine Cross-Validation Results<a class="headerlink" href="#combine-cross-validation-results" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id24">
<h1>â€œâ€â€<a class="headerlink" href="#id24" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id25">
<h1><a class="headerlink" href="#id25" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id26">
<h1># %%<a class="headerlink" href="#id26" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="neural-cv-df-no-target-neural-cv-df-drop-columns-col-for-col-in-y-if-col-in-neural-cv-df-columns">
<h1>neural_cv_df_no_target = neural_cv_df.drop(columns=[col for col in [â€œyâ€] if col in neural_cv_df.columns])<a class="headerlink" href="#neural-cv-df-no-target-neural-cv-df-drop-columns-col-for-col-in-y-if-col-in-neural-cv-df-columns" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="cv-df-pd-merge">
<h1>cv_df = pd.merge(<a class="headerlink" href="#cv-df-pd-merge" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="stats-cv-df">
<h1>stats_cv_df,<a class="headerlink" href="#stats-cv-df" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="neural-cv-df-no-target">
<h1>neural_cv_df_no_target,<a class="headerlink" href="#neural-cv-df-no-target" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="on-unique-id-ds-cutoff">
<h1>on=[â€œunique_idâ€, â€œdsâ€, â€œcutoffâ€],<a class="headerlink" href="#on-unique-id-ds-cutoff" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="how-inner">
<h1>how=â€œinnerâ€,<a class="headerlink" href="#how-inner" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id27">
<h1>)<a class="headerlink" href="#id27" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="cv-df-head">
<h1>cv_df.head()<a class="headerlink" href="#cv-df-head" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id28">
<h1><a class="headerlink" href="#id28" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id29">
<h1># %%<a class="headerlink" href="#id29" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id30">
<h1>â€œâ€â€<a class="headerlink" href="#id30" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="evaluate-model-performance">
<h1>## Evaluate Model Performance<a class="headerlink" href="#evaluate-model-performance" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id31">
<h1><a class="headerlink" href="#id31" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculate-error-metrics-for-each-model-across-all-cross-validation-windows">
<h1>Calculate error metrics for each model across all cross-validation windows:<a class="headerlink" href="#calculate-error-metrics-for-each-model-across-all-cross-validation-windows" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mase-mean-absolute-scaled-error-scale-independent-metric">
<h1>- MASE (Mean Absolute Scaled Error): Scale-independent metric<a class="headerlink" href="#mase-mean-absolute-scaled-error-scale-independent-metric" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mse-mean-squared-error-penalizes-large-errors">
<h1>- MSE (Mean Squared Error): Penalizes large errors<a class="headerlink" href="#mse-mean-squared-error-penalizes-large-errors" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="rmse-root-mean-squared-error-in-same-units-as-original-data">
<h1>- RMSE (Root Mean Squared Error): In same units as original data<a class="headerlink" href="#rmse-root-mean-squared-error-in-same-units-as-original-data" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id32">
<h1>â€œâ€â€<a class="headerlink" href="#id32" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id33">
<h1><a class="headerlink" href="#id33" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id34">
<h1># %%<a class="headerlink" href="#id34" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="import-numpy-as-np">
<h1>import numpy as np<a class="headerlink" href="#import-numpy-as-np" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id35">
<h1><a class="headerlink" href="#id35" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id36">
<h1># %%<a class="headerlink" href="#id36" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="def-select-point-forecast-columns-df">
<h1>def select_point_forecast_columns(df):<a class="headerlink" href="#def-select-point-forecast-columns-df" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="return-the-forecast-columns-excluding-prediction-interval-outputs">
<h1>â€œâ€â€œReturn the forecast columns excluding prediction interval outputs.â€â€œâ€<a class="headerlink" href="#return-the-forecast-columns-excluding-prediction-interval-outputs" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id37">
<h1><a class="headerlink" href="#id37" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="exclude-cols-unique-id-ds-y-cutoff">
<h1>exclude_cols = {â€œunique_idâ€, â€œdsâ€, â€œyâ€, â€œcutoffâ€}<a class="headerlink" href="#exclude-cols-unique-id-ds-y-cutoff" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="point-cols">
<h1>point_cols = []<a class="headerlink" href="#point-cols" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id38">
<h1><a class="headerlink" href="#id38" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="for-col-in-df-columns">
<h1>for col in df.columns:<a class="headerlink" href="#for-col-in-df-columns" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="if-col-in-exclude-cols">
<h1>if col in exclude_cols:<a class="headerlink" href="#if-col-in-exclude-cols" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="continue">
<h1>continue<a class="headerlink" href="#continue" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id39">
<h1><a class="headerlink" href="#id39" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="col-lower-col-lower">
<h1>col_lower = col.lower()<a class="headerlink" href="#col-lower-col-lower" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="if-any-token-in-col-lower-for-token-in-lo-hi">
<h1>if any(token in col_lower for token in [â€œ-lo-â€, â€œ-hi-â€]):<a class="headerlink" href="#if-any-token-in-col-lower-for-token-in-lo-hi" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id40">
<h1>continue<a class="headerlink" href="#id40" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="if-col-lower-endswith-median">
<h1>if col_lower.endswith(â€œ-medianâ€):<a class="headerlink" href="#if-col-lower-endswith-median" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id41">
<h1>continue<a class="headerlink" href="#id41" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id42">
<h1><a class="headerlink" href="#id42" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="point-cols-append-col">
<h1>point_cols.append(col)<a class="headerlink" href="#point-cols-append-col" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id43">
<h1><a class="headerlink" href="#id43" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="return-point-cols">
<h1>return point_cols<a class="headerlink" href="#return-point-cols" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id44">
<h1><a class="headerlink" href="#id44" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id45">
<h1># %%<a class="headerlink" href="#id45" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculate-mase-needs-training-data-for-scaling">
<h1># Calculate MASE (needs training data for scaling)<a class="headerlink" href="#calculate-mase-needs-training-data-for-scaling" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="for-mase-we-need-to-create-a-naive-forecast-baseline">
<h1># For MASE, we need to create a naive forecast baseline<a class="headerlink" href="#for-mase-we-need-to-create-a-naive-forecast-baseline" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="use-the-training-data-to-compute-seasonal-naive-errors-for-scaling">
<h1># Use the training data to compute seasonal naive errors for scaling<a class="headerlink" href="#use-the-training-data-to-compute-seasonal-naive-errors-for-scaling" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mase-scores">
<h1>mase_scores = {}<a class="headerlink" href="#mase-scores" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mse-scores">
<h1>mse_scores = {}<a class="headerlink" href="#mse-scores" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="rmse-scores">
<h1>rmse_scores = {}<a class="headerlink" href="#rmse-scores" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id46">
<h1><a class="headerlink" href="#id46" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="model-cols-select-point-forecast-columns-cv-df">
<h1>model_cols = select_point_forecast_columns(cv_df)<a class="headerlink" href="#model-cols-select-point-forecast-columns-cv-df" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id47">
<h1><a class="headerlink" href="#id47" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="for-model-col-in-model-cols">
<h1>for model_col in model_cols:<a class="headerlink" href="#for-model-col-in-model-cols" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculate-mse">
<h1># Calculate MSE<a class="headerlink" href="#calculate-mse" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="model-mse-cv-df-y-cv-df-model-col-2-mean">
<h1>model_mse = ((cv_df[â€œyâ€] - cv_df[model_col]) ** 2).mean()<a class="headerlink" href="#model-mse-cv-df-y-cv-df-model-col-2-mean" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mse-scores-model-col-model-mse">
<h1>mse_scores[model_col] = model_mse<a class="headerlink" href="#mse-scores-model-col-model-mse" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="rmse-scores-model-col-np-sqrt-model-mse">
<h1>rmse_scores[model_col] = np.sqrt(model_mse)<a class="headerlink" href="#rmse-scores-model-col-np-sqrt-model-mse" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id48">
<h1><a class="headerlink" href="#id48" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculate-mase-using-seasonal-naive-as-baseline">
<h1># Calculate MASE (using seasonal naive as baseline)<a class="headerlink" href="#calculate-mase-using-seasonal-naive-as-baseline" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mase-mae-mae-baseline-where-baseline-is-seasonal-naive">
<h1># MASE = MAE / MAE_baseline where baseline is seasonal naive<a class="headerlink" href="#mase-mae-mae-baseline-where-baseline-is-seasonal-naive" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mae-np-abs-cv-df-y-cv-df-model-col-mean">
<h1>mae = np.abs(cv_df[â€œyâ€] - cv_df[model_col]).mean()<a class="headerlink" href="#mae-np-abs-cv-df-y-cv-df-model-col-mean" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id49">
<h1><a class="headerlink" href="#id49" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="seasonal-naive-baseline-compare-with-value-from-season-length-periods-ago">
<h1># Seasonal naive baseline (compare with value from season_length periods ago)<a class="headerlink" href="#seasonal-naive-baseline-compare-with-value-from-season-length-periods-ago" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="for-the-training-set">
<h1># For the training set<a class="headerlink" href="#for-the-training-set" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="train-y-train-df-y-values">
<h1>train_y = train_df[â€œyâ€].values<a class="headerlink" href="#train-y-train-df-y-values" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="if-len-train-y-season-length">
<h1>if len(train_y) &gt; season_length:<a class="headerlink" href="#if-len-train-y-season-length" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="naive-errors-np-abs-train-y-season-length-train-y-season-length">
<h1>naive_errors = np.abs(train_y[season_length:] - train_y[:-season_length])<a class="headerlink" href="#naive-errors-np-abs-train-y-season-length-train-y-season-length" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="else">
<h1>else:<a class="headerlink" href="#else" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="naive-errors-np-abs-np-diff-train-y">
<h1>naive_errors = np.abs(np.diff(train_y))<a class="headerlink" href="#naive-errors-np-abs-np-diff-train-y" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mae-baseline-naive-errors-mean">
<h1>mae_baseline = naive_errors.mean()<a class="headerlink" href="#mae-baseline-naive-errors-mean" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id50">
<h1><a class="headerlink" href="#id50" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mase-scores-model-col-mae-mae-baseline-if-mae-baseline-0-else-np-inf">
<h1>mase_scores[model_col] = mae / mae_baseline if mae_baseline &gt; 0 else np.inf<a class="headerlink" href="#mase-scores-model-col-mae-mae-baseline-if-mae-baseline-0-else-np-inf" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id51">
<h1><a class="headerlink" href="#id51" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id52">
<h1># %%<a class="headerlink" href="#id52" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id53">
<h1>â€œâ€â€<a class="headerlink" href="#id53" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="model-performance-summary">
<h1>## Model Performance Summary<a class="headerlink" href="#model-performance-summary" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id54">
<h1><a class="headerlink" href="#id54" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="compare-all-models-across-the-three-metrics">
<h1>Compare all models across the three metrics.<a class="headerlink" href="#compare-all-models-across-the-three-metrics" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="lower-values-are-better-for-all-metrics">
<h1>Lower values are better for all metrics.<a class="headerlink" href="#lower-values-are-better-for-all-metrics" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id55">
<h1><a class="headerlink" href="#id55" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="interpretation">
<h1>Interpretation:<a class="headerlink" href="#interpretation" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mase-1-better-than-seasonal-naive-baseline">
<h1>- MASE &lt; 1: Better than seasonal naive baseline<a class="headerlink" href="#mase-1-better-than-seasonal-naive-baseline" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mase-1-same-as-seasonal-naive">
<h1>- MASE = 1: Same as seasonal naive<a class="headerlink" href="#mase-1-same-as-seasonal-naive" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mase-1-worse-than-seasonal-naive">
<h1>- MASE &gt; 1: Worse than seasonal naive<a class="headerlink" href="#mase-1-worse-than-seasonal-naive" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id56">
<h1>â€œâ€â€<a class="headerlink" href="#id56" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id57">
<h1><a class="headerlink" href="#id57" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id58">
<h1># %%<a class="headerlink" href="#id58" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="import-pandas-as-pd">
<h1>import pandas as pd<a class="headerlink" href="#import-pandas-as-pd" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id59">
<h1><a class="headerlink" href="#id59" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id60">
<h1># %%<a class="headerlink" href="#id60" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="create-comparison-table">
<h1># Create comparison table<a class="headerlink" href="#create-comparison-table" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="comparison-df-pd-dataframe">
<h1>comparison_df = pd.DataFrame({<a class="headerlink" href="#comparison-df-pd-dataframe" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="model-model-cols">
<h1>â€œModelâ€: model_cols,<a class="headerlink" href="#model-model-cols" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mase-mase-scores-m-for-m-in-model-cols">
<h1>â€œMASEâ€: [mase_scores[m] for m in model_cols],<a class="headerlink" href="#mase-mase-scores-m-for-m-in-model-cols" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mse-mse-scores-m-for-m-in-model-cols">
<h1>â€œMSEâ€: [mse_scores[m] for m in model_cols],<a class="headerlink" href="#mse-mse-scores-m-for-m-in-model-cols" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="rmse-rmse-scores-m-for-m-in-model-cols">
<h1>â€œRMSEâ€: [rmse_scores[m] for m in model_cols],<a class="headerlink" href="#rmse-rmse-scores-m-for-m-in-model-cols" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id61">
<h1>})<a class="headerlink" href="#id61" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id62">
<h1><a class="headerlink" href="#id62" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="sort-by-mase-lower-is-better">
<h1># Sort by MASE (lower is better)<a class="headerlink" href="#sort-by-mase-lower-is-better" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="comparison-df-comparison-df-sort-values-mase">
<h1>comparison_df = comparison_df.sort_values(â€œMASEâ€)<a class="headerlink" href="#comparison-df-comparison-df-sort-values-mase" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="comparison-df">
<h1>comparison_df<a class="headerlink" href="#comparison-df" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id63">
<h1><a class="headerlink" href="#id63" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id64">
<h1># %%<a class="headerlink" href="#id64" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id65">
<h1>â€œâ€â€<a class="headerlink" href="#id65" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="visualize-model-rankings">
<h1>## Visualize Model Rankings<a class="headerlink" href="#visualize-model-rankings" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id66">
<h1><a class="headerlink" href="#id66" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="create-a-visual-comparison-of-model-performance-across-metrics">
<h1>Create a visual comparison of model performance across metrics.<a class="headerlink" href="#create-a-visual-comparison-of-model-performance-across-metrics" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id67">
<h1>â€œâ€â€<a class="headerlink" href="#id67" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id68">
<h1><a class="headerlink" href="#id68" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id69">
<h1># %%<a class="headerlink" href="#id69" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="fig-axes-plt-subplots-1-3-figsize-15-5">
<h1>fig, axes = plt.subplots(1, 3, figsize=(15, 5))<a class="headerlink" href="#fig-axes-plt-subplots-1-3-figsize-15-5" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id70">
<h1><a class="headerlink" href="#id70" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mase">
<h1># MASE<a class="headerlink" href="#mase" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-0-barh-comparison-df-model-comparison-df-mase">
<h1>axes[0].barh(comparison_df[â€œModelâ€], comparison_df[â€œMASEâ€])<a class="headerlink" href="#axes-0-barh-comparison-df-model-comparison-df-mase" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-0-set-xlabel-mase">
<h1>axes[0].set_xlabel(â€œMASEâ€)<a class="headerlink" href="#axes-0-set-xlabel-mase" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-0-set-title-mean-absolute-scaled-error-n-lower-is-better">
<h1>axes[0].set_title(â€œMean Absolute Scaled Error\n(Lower is Better)â€)<a class="headerlink" href="#axes-0-set-title-mean-absolute-scaled-error-n-lower-is-better" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-0-axvline-x-1-0-color-r-linestyle-label-naive-baseline">
<h1>axes[0].axvline(x=1.0, color=â€˜râ€™, linestyle=â€˜â€“â€™, label=â€˜Naive Baselineâ€™)<a class="headerlink" href="#axes-0-axvline-x-1-0-color-r-linestyle-label-naive-baseline" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-0-legend">
<h1>axes[0].legend()<a class="headerlink" href="#axes-0-legend" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id71">
<h1><a class="headerlink" href="#id71" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mse">
<h1># MSE<a class="headerlink" href="#mse" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-1-barh-comparison-df-model-comparison-df-mse">
<h1>axes[1].barh(comparison_df[â€œModelâ€], comparison_df[â€œMSEâ€])<a class="headerlink" href="#axes-1-barh-comparison-df-model-comparison-df-mse" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-1-set-xlabel-mse">
<h1>axes[1].set_xlabel(â€œMSEâ€)<a class="headerlink" href="#axes-1-set-xlabel-mse" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-1-set-title-mean-squared-error-n-lower-is-better">
<h1>axes[1].set_title(â€œMean Squared Error\n(Lower is Better)â€)<a class="headerlink" href="#axes-1-set-title-mean-squared-error-n-lower-is-better" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id72">
<h1><a class="headerlink" href="#id72" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="rmse">
<h1># RMSE<a class="headerlink" href="#rmse" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-2-barh-comparison-df-model-comparison-df-rmse">
<h1>axes[2].barh(comparison_df[â€œModelâ€], comparison_df[â€œRMSEâ€])<a class="headerlink" href="#axes-2-barh-comparison-df-model-comparison-df-rmse" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-2-set-xlabel-rmse">
<h1>axes[2].set_xlabel(â€œRMSEâ€)<a class="headerlink" href="#axes-2-set-xlabel-rmse" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="axes-2-set-title-root-mean-squared-error-n-lower-is-better">
<h1>axes[2].set_title(â€œRoot Mean Squared Error\n(Lower is Better)â€)<a class="headerlink" href="#axes-2-set-title-root-mean-squared-error-n-lower-is-better" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id73">
<h1><a class="headerlink" href="#id73" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plt-tight-layout">
<h1>plt.tight_layout()<a class="headerlink" href="#plt-tight-layout" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="save-and-show-plot-example-forecasts-model-rankings-png">
<h1>save_and_show_plot(â€œexample_forecasts_model_rankings.pngâ€)<a class="headerlink" href="#save-and-show-plot-example-forecasts-model-rankings-png" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id74">
<h1><a class="headerlink" href="#id74" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id75">
<h1># %%<a class="headerlink" href="#id75" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id76">
<h1>â€œâ€â€<a class="headerlink" href="#id76" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="identify-best-model">
<h1>## Identify Best Model<a class="headerlink" href="#identify-best-model" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id77">
<h1><a class="headerlink" href="#id77" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="select-the-model-with-the-lowest-mase-score-and-visualize-its-performance">
<h1>Select the model with the lowest MASE score and visualize its performance.<a class="headerlink" href="#select-the-model-with-the-lowest-mase-score-and-visualize-its-performance" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id78">
<h1>â€œâ€â€<a class="headerlink" href="#id78" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id79">
<h1><a class="headerlink" href="#id79" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id80">
<h1># %%<a class="headerlink" href="#id80" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="best-model-comparison-df-iloc-0-model">
<h1>best_model = comparison_df.iloc[0][â€œModelâ€]<a class="headerlink" href="#best-model-comparison-df-iloc-0-model" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="print-f-best-performing-model-best-model">
<h1>print(fâ€Best performing model: {best_model}â€)<a class="headerlink" href="#print-f-best-performing-model-best-model" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="print-f-mase-comparison-df-iloc-0-mase-4f">
<h1>print(fâ€MASE: {comparison_df.iloc[0][â€˜MASEâ€™]:.4f}â€)<a class="headerlink" href="#print-f-mase-comparison-df-iloc-0-mase-4f" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="print-f-rmse-comparison-df-iloc-0-rmse-4f">
<h1>print(fâ€RMSE: {comparison_df.iloc[0][â€˜RMSEâ€™]:.4f}â€)<a class="headerlink" href="#print-f-rmse-comparison-df-iloc-0-rmse-4f" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id81">
<h1><a class="headerlink" href="#id81" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id82">
<h1># %%<a class="headerlink" href="#id82" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="visualize-best-models-forecast-with-actuals">
<h1># Visualize best modelâ€™s forecast with actuals<a class="headerlink" href="#visualize-best-models-forecast-with-actuals" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="best-forecast-combined-forecasts-df-combined-forecasts-df-unique-id-arb-2">
<h1>best_forecast = combined_forecasts_df[combined_forecasts_df[â€œunique_idâ€] == â€œarb_2â€]<a class="headerlink" href="#best-forecast-combined-forecasts-df-combined-forecasts-df-unique-id-arb-2" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id83">
<h1><a class="headerlink" href="#id83" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="fig-ax-plt-subplots-figsize-12-5">
<h1>fig, ax = plt.subplots(figsize=(12, 5))<a class="headerlink" href="#fig-ax-plt-subplots-figsize-12-5" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ax-plot-train-df-ds-train-df-y-label-train-color-tab-blue-alpha-0-6">
<h1>ax.plot(train_df[â€œdsâ€], train_df[â€œyâ€], label=â€œTrainâ€, color=â€œtab:blueâ€, alpha=0.6)<a class="headerlink" href="#ax-plot-train-df-ds-train-df-y-label-train-color-tab-blue-alpha-0-6" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ax-plot-test-df-ds-test-df-y-label-actual-test-color-black-linewidth-2">
<h1>ax.plot(test_df[â€œdsâ€], test_df[â€œyâ€], label=â€œActual (Test)â€, color=â€œblackâ€, linewidth=2)<a class="headerlink" href="#ax-plot-test-df-ds-test-df-y-label-actual-test-color-black-linewidth-2" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ax-plot">
<h1>ax.plot(<a class="headerlink" href="#ax-plot" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="best-forecast-ds">
<h1>best_forecast[â€œdsâ€],<a class="headerlink" href="#best-forecast-ds" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="best-forecast-best-model">
<h1>best_forecast[best_model],<a class="headerlink" href="#best-forecast-best-model" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="label-f-forecast-best-model">
<h1>label=fâ€Forecast ({best_model})â€,<a class="headerlink" href="#label-f-forecast-best-model" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="linewidth-2">
<h1>linewidth=2,<a class="headerlink" href="#linewidth-2" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id84">
<h1>)<a class="headerlink" href="#id84" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id85">
<h1><a class="headerlink" href="#id85" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="lower-col-f-best-model-lo-90">
<h1>lower_col = fâ€{best_model}-lo-90â€<a class="headerlink" href="#lower-col-f-best-model-lo-90" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="upper-col-f-best-model-hi-90">
<h1>upper_col = fâ€{best_model}-hi-90â€<a class="headerlink" href="#upper-col-f-best-model-hi-90" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="if-lower-col-in-best-forecast-columns-and-upper-col-in-best-forecast-columns">
<h1>if lower_col in best_forecast.columns and upper_col in best_forecast.columns:<a class="headerlink" href="#if-lower-col-in-best-forecast-columns-and-upper-col-in-best-forecast-columns" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ax-fill-between">
<h1>ax.fill_between(<a class="headerlink" href="#ax-fill-between" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id86">
<h1>best_forecast[â€œdsâ€],<a class="headerlink" href="#id86" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="best-forecast-lower-col">
<h1>best_forecast[lower_col],<a class="headerlink" href="#best-forecast-lower-col" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="best-forecast-upper-col">
<h1>best_forecast[upper_col],<a class="headerlink" href="#best-forecast-upper-col" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="alpha-0-2">
<h1>alpha=0.2,<a class="headerlink" href="#alpha-0-2" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="color-tab-orange">
<h1>color=â€œtab:orangeâ€,<a class="headerlink" href="#color-tab-orange" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="label-90-interval">
<h1>label=â€œ90% intervalâ€,<a class="headerlink" href="#label-90-interval" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id87">
<h1>)<a class="headerlink" href="#id87" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id88">
<h1><a class="headerlink" href="#id88" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ax-set-title-f-best-model-best-model-forecast-vs-actual">
<h1>ax.set_title(fâ€Best Model ({best_model}) Forecast vs Actualâ€)<a class="headerlink" href="#ax-set-title-f-best-model-best-model-forecast-vs-actual" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ax-set-xlabel-date">
<h1>ax.set_xlabel(â€œDateâ€)<a class="headerlink" href="#ax-set-xlabel-date" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ax-set-ylabel-basis-spread">
<h1>ax.set_ylabel(â€œBasis Spreadâ€)<a class="headerlink" href="#ax-set-ylabel-basis-spread" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ax-legend-loc-upper-left">
<h1>ax.legend(loc=â€œupper leftâ€)<a class="headerlink" href="#ax-legend-loc-upper-left" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id89">
<h1>plt.tight_layout()<a class="headerlink" href="#id89" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="save-and-show-plot-example-forecasts-best-model-png">
<h1>save_and_show_plot(â€œexample_forecasts_best_model.pngâ€)<a class="headerlink" href="#save-and-show-plot-example-forecasts-best-model-png" title="Link to this heading">#</a></h1>
<section id="insights-and-conclusions">
<h2>Insights and Conclusions<a class="headerlink" href="#insights-and-conclusions" title="Link to this heading">#</a></h2>
<section id="key-findings">
<h3>Key Findings:<a class="headerlink" href="#key-findings" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Best Model</strong>: The model with the lowest MASE performs best at forecasting
the 2-year TIPS-Treasury basis spread.</p></li>
<li><p><strong>Model Comparison</strong>:</p>
<ul class="simple">
<li><p>The auto neural family (N-BEATS, NHITS, TiDE, Transformer) explores rich function spaces
and can outperform statistical baselines when structural breaks are limited.</p></li>
<li><p>AutoARIMA and Theta remain strong interpretable baselines that often compete closely
thanks to annual differencing and mean-reverting behavior.</p></li>
<li><p>SES provides a lightweight control, highlighting how much the more expressive models gain.</p></li>
</ul>
</li>
<li><p><strong>Why This Matters</strong>:</p>
<ul class="simple">
<li><p>TIPS-Treasury basis spreads represent arbitrage opportunities</p></li>
<li><p>Understanding which models work helps identify when spreads deviate from expected patterns</p></li>
<li><p>Poor model performance might indicate structural breaks or regime changes</p></li>
</ul>
</li>
</ol>
</section>
<section id="next-steps">
<h3>Next Steps:<a class="headerlink" href="#next-steps" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Experiment with different forecast horizons</p></li>
<li><p>Try models with exogenous variables (volatility, liquidity measures)</p></li>
<li><p>Compare performance across different maturities (2yr, 5yr, 10yr, 20yr)</p></li>
<li><p>Investigate periods where all models perform poorly (potential regime changes)</p></li>
</ul>
</section>
</section>
<section id="appendix-individual-model-analysis">
<h2>Appendix: Individual Model Analysis<a class="headerlink" href="#appendix-individual-model-analysis" title="Link to this heading">#</a></h2>
<p>For deeper investigation, we can look at each modelâ€™s forecasts individually
to understand their specific behavior patterns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Show forecast statistics for each model</span>
<span class="c1"># for model in model_cols[:3]:  # Show first 3 models as example</span>
<span class="c1">#     print(f&quot;\n{model} Forecast Statistics:&quot;)</span>
<span class="c1">#     print(f&quot;Mean: {combined_forecasts_df[model].mean():.4f}&quot;)</span>
<span class="c1">#     print(f&quot;Std: {combined_forecasts_df[model].std():.4f}&quot;)</span>
<span class="c1">#     print(f&quot;Min: {combined_forecasts_df[model].min():.4f}&quot;)</span>
<span class="c1">#     print(f&quot;Max: {combined_forecasts_df[model].max():.4f}&quot;)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">TIPS-Treasury Basis Spread Forecasting Walkthrough</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-prepare-data">Load and Prepare Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">Data Exploration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-full-time-series">Visualize the Full Time Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-test-split">Train/Test Split</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-models-for-comparison">Define Models for Comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-statsforecast">Initialize StatsForecast</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-point-forecasts">Generate Point Forecasts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fit-auto-neural-models">Fit Auto Neural Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combine-forecasts-across-all-models">Combine Forecasts Across All Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-forecasts-vs-actuals">Visualize Forecasts vs Actuals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#focus-on-specific-models">Focus on Specific Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-auto-neural-forecasts">Visualize Auto Neural Forecasts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation-for-robust-evaluation-commented-out-for-debugging">Cross-Validation for Robust Evaluation (COMMENTED OUT FOR DEBUGGING)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#instead-of-a-single-train-test-split-well-use-cross-validation-with-multiple">Instead of a single train/test split, weâ€™ll use cross-validation with multiple</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#windows-to-get-a-more-robust-assessment-of-model-performance">windows to get a more robust assessment of model performance.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#well-use">Weâ€™ll use:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#forecast-horizon-12-months-matching-the-held-out-forecast-horizon">- Forecast horizon: 12 months (matching the held-out forecast horizon)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#step-size-12-months-non-overlapping-windows">- Step size: 12 months (non-overlapping windows)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#up-to-5-windows-limited-by-data-length">- Up to 5 windows (limited by data length)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cv-horizon-forecast-horizon">cv_horizon = forecast_horizon</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#max-windows-max-1-len-y-df-cv-horizon-1">max_windows = max(1, (len(Y_df) // cv_horizon) - 1)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cv-windows-min-5-max-windows">cv_windows = min(5, max_windows)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stats-cv-df-sf-cross-validation">stats_cv_df = sf.cross_validation(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#df-y-df">df=Y_df,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#h-cv-horizon">h=cv_horizon,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#step-size-cv-horizon">step_size=cv_horizon,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#n-windows-cv-windows">n_windows=cv_windows,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stats-cv-df-head">stats_cv_df.head()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cross-validation">### Neural Cross-Validation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#refit-the-auto-neural-models-within-the-cross-validation-windows-to-evaluate">Refit the auto neural models within the cross-validation windows to evaluate</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#their-stability-across-different-training-periods">their stability across different training periods.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-models-build-auto-neural-models-cv-horizon-auto-logs-dir-cv">neural_cv_models = build_auto_neural_models(cv_horizon, auto_logs_dir / â€œcvâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#nf-cv-neuralforecast-models-neural-cv-models-freq-bme">nf_cv = NeuralForecast(models=neural_cv_models, freq=â€œBMEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-df-nf-cv-cross-validation">neural_cv_df = nf_cv.cross_validation(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">df=Y_df,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">n_windows=cv_windows,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">step_size=cv_horizon,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-df-head">neural_cv_df.head()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id21"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id22"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#combine-cross-validation-results">### Combine Cross-Validation Results</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id25"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id26"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-df-no-target-neural-cv-df-drop-columns-col-for-col-in-y-if-col-in-neural-cv-df-columns">neural_cv_df_no_target = neural_cv_df.drop(columns=[col for col in [â€œyâ€] if col in neural_cv_df.columns])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cv-df-pd-merge">cv_df = pd.merge(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stats-cv-df">stats_cv_df,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-cv-df-no-target">neural_cv_df_no_target,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#on-unique-id-ds-cutoff">on=[â€œunique_idâ€, â€œdsâ€, â€œcutoffâ€],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#how-inner">how=â€œinnerâ€,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cv-df-head">cv_df.head()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id28"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id29"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-model-performance">## Evaluate Model Performance</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id31"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-error-metrics-for-each-model-across-all-cross-validation-windows">Calculate error metrics for each model across all cross-validation windows:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-mean-absolute-scaled-error-scale-independent-metric">- MASE (Mean Absolute Scaled Error): Scale-independent metric</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-mean-squared-error-penalizes-large-errors">- MSE (Mean Squared Error): Penalizes large errors</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-root-mean-squared-error-in-same-units-as-original-data">- RMSE (Root Mean Squared Error): In same units as original data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id33"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id34"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-numpy-as-np">import numpy as np</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id35"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id36"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#def-select-point-forecast-columns-df">def select_point_forecast_columns(df):</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#return-the-forecast-columns-excluding-prediction-interval-outputs">â€œâ€â€œReturn the forecast columns excluding prediction interval outputs.â€â€œâ€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id37"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exclude-cols-unique-id-ds-y-cutoff">exclude_cols = {â€œunique_idâ€, â€œdsâ€, â€œyâ€, â€œcutoffâ€}</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#point-cols">point_cols = []</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id38"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#for-col-in-df-columns">for col in df.columns:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-col-in-exclude-cols">if col in exclude_cols:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#continue">continue</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id39"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#col-lower-col-lower">col_lower = col.lower()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-any-token-in-col-lower-for-token-in-lo-hi">if any(token in col_lower for token in [â€œ-lo-â€, â€œ-hi-â€]):</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id40">continue</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-col-lower-endswith-median">if col_lower.endswith(â€œ-medianâ€):</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id41">continue</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id42"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#point-cols-append-col">point_cols.append(col)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id43"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#return-point-cols">return point_cols</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id44"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id45"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mase-needs-training-data-for-scaling"># Calculate MASE (needs training data for scaling)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#for-mase-we-need-to-create-a-naive-forecast-baseline"># For MASE, we need to create a naive forecast baseline</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-training-data-to-compute-seasonal-naive-errors-for-scaling"># Use the training data to compute seasonal naive errors for scaling</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-scores">mase_scores = {}</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-scores">mse_scores = {}</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-scores">rmse_scores = {}</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id46"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-cols-select-point-forecast-columns-cv-df">model_cols = select_point_forecast_columns(cv_df)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id47"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#for-model-col-in-model-cols">for model_col in model_cols:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mse"># Calculate MSE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-mse-cv-df-y-cv-df-model-col-2-mean">model_mse = ((cv_df[â€œyâ€] - cv_df[model_col]) ** 2).mean()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-scores-model-col-model-mse">mse_scores[model_col] = model_mse</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-scores-model-col-np-sqrt-model-mse">rmse_scores[model_col] = np.sqrt(model_mse)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id48"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-mase-using-seasonal-naive-as-baseline"># Calculate MASE (using seasonal naive as baseline)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-mae-mae-baseline-where-baseline-is-seasonal-naive"># MASE = MAE / MAE_baseline where baseline is seasonal naive</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mae-np-abs-cv-df-y-cv-df-model-col-mean">mae = np.abs(cv_df[â€œyâ€] - cv_df[model_col]).mean()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id49"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seasonal-naive-baseline-compare-with-value-from-season-length-periods-ago"># Seasonal naive baseline (compare with value from season_length periods ago)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#for-the-training-set"># For the training set</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#train-y-train-df-y-values">train_y = train_df[â€œyâ€].values</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-len-train-y-season-length">if len(train_y) &gt; season_length:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-errors-np-abs-train-y-season-length-train-y-season-length">naive_errors = np.abs(train_y[season_length:] - train_y[:-season_length])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#else">else:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-errors-np-abs-np-diff-train-y">naive_errors = np.abs(np.diff(train_y))</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mae-baseline-naive-errors-mean">mae_baseline = naive_errors.mean()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id50"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-scores-model-col-mae-mae-baseline-if-mae-baseline-0-else-np-inf">mase_scores[model_col] = mae / mae_baseline if mae_baseline &gt; 0 else np.inf</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id51"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id52"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id53">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-performance-summary">## Model Performance Summary</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id54"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-all-models-across-the-three-metrics">Compare all models across the three metrics.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lower-values-are-better-for-all-metrics">Lower values are better for all metrics.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id55"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation">Interpretation:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-1-better-than-seasonal-naive-baseline">- MASE &lt; 1: Better than seasonal naive baseline</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-1-same-as-seasonal-naive">- MASE = 1: Same as seasonal naive</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-1-worse-than-seasonal-naive">- MASE &gt; 1: Worse than seasonal naive</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id56">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id57"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id58"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#import-pandas-as-pd">import pandas as pd</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id59"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id60"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#create-comparison-table"># Create comparison table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-df-pd-dataframe">comparison_df = pd.DataFrame({</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#model-model-cols">â€œModelâ€: model_cols,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase-mase-scores-m-for-m-in-model-cols">â€œMASEâ€: [mase_scores[m] for m in model_cols],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-mse-scores-m-for-m-in-model-cols">â€œMSEâ€: [mse_scores[m] for m in model_cols],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-rmse-scores-m-for-m-in-model-cols">â€œRMSEâ€: [rmse_scores[m] for m in model_cols],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id61">})</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id62"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sort-by-mase-lower-is-better"># Sort by MASE (lower is better)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-df-comparison-df-sort-values-mase">comparison_df = comparison_df.sort_values(â€œMASEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-df">comparison_df</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id63"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id64"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id65">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-model-rankings">## Visualize Model Rankings</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id66"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-visual-comparison-of-model-performance-across-metrics">Create a visual comparison of model performance across metrics.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id67">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id68"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id69"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fig-axes-plt-subplots-1-3-figsize-15-5">fig, axes = plt.subplots(1, 3, figsize=(15, 5))</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id70"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mase"># MASE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-barh-comparison-df-model-comparison-df-mase">axes[0].barh(comparison_df[â€œModelâ€], comparison_df[â€œMASEâ€])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-set-xlabel-mase">axes[0].set_xlabel(â€œMASEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-set-title-mean-absolute-scaled-error-n-lower-is-better">axes[0].set_title(â€œMean Absolute Scaled Error\n(Lower is Better)â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-axvline-x-1-0-color-r-linestyle-label-naive-baseline">axes[0].axvline(x=1.0, color=â€˜râ€™, linestyle=â€˜â€“â€™, label=â€˜Naive Baselineâ€™)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-0-legend">axes[0].legend()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id71"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mse"># MSE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-1-barh-comparison-df-model-comparison-df-mse">axes[1].barh(comparison_df[â€œModelâ€], comparison_df[â€œMSEâ€])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-1-set-xlabel-mse">axes[1].set_xlabel(â€œMSEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-1-set-title-mean-squared-error-n-lower-is-better">axes[1].set_title(â€œMean Squared Error\n(Lower is Better)â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id72"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse"># RMSE</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-2-barh-comparison-df-model-comparison-df-rmse">axes[2].barh(comparison_df[â€œModelâ€], comparison_df[â€œRMSEâ€])</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-2-set-xlabel-rmse">axes[2].set_xlabel(â€œRMSEâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-2-set-title-root-mean-squared-error-n-lower-is-better">axes[2].set_title(â€œRoot Mean Squared Error\n(Lower is Better)â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id73"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plt-tight-layout">plt.tight_layout()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-show-plot-example-forecasts-model-rankings-png">save_and_show_plot(â€œexample_forecasts_model_rankings.pngâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id74"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id75"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id76">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#identify-best-model">## Identify Best Model</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id77"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#select-the-model-with-the-lowest-mase-score-and-visualize-its-performance">Select the model with the lowest MASE score and visualize its performance.</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id78">â€œâ€â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id79"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id80"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-model-comparison-df-iloc-0-model">best_model = comparison_df.iloc[0][â€œModelâ€]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#print-f-best-performing-model-best-model">print(fâ€Best performing model: {best_model}â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#print-f-mase-comparison-df-iloc-0-mase-4f">print(fâ€MASE: {comparison_df.iloc[0][â€˜MASEâ€™]:.4f}â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#print-f-rmse-comparison-df-iloc-0-rmse-4f">print(fâ€RMSE: {comparison_df.iloc[0][â€˜RMSEâ€™]:.4f}â€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id81"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id82"># %%</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-best-models-forecast-with-actuals"># Visualize best modelâ€™s forecast with actuals</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-combined-forecasts-df-combined-forecasts-df-unique-id-arb-2">best_forecast = combined_forecasts_df[combined_forecasts_df[â€œunique_idâ€] == â€œarb_2â€]</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id83"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fig-ax-plt-subplots-figsize-12-5">fig, ax = plt.subplots(figsize=(12, 5))</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-plot-train-df-ds-train-df-y-label-train-color-tab-blue-alpha-0-6">ax.plot(train_df[â€œdsâ€], train_df[â€œyâ€], label=â€œTrainâ€, color=â€œtab:blueâ€, alpha=0.6)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-plot-test-df-ds-test-df-y-label-actual-test-color-black-linewidth-2">ax.plot(test_df[â€œdsâ€], test_df[â€œyâ€], label=â€œActual (Test)â€, color=â€œblackâ€, linewidth=2)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-plot">ax.plot(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-ds">best_forecast[â€œdsâ€],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-best-model">best_forecast[best_model],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#label-f-forecast-best-model">label=fâ€Forecast ({best_model})â€,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linewidth-2">linewidth=2,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id84">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id85"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lower-col-f-best-model-lo-90">lower_col = fâ€{best_model}-lo-90â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#upper-col-f-best-model-hi-90">upper_col = fâ€{best_model}-hi-90â€</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#if-lower-col-in-best-forecast-columns-and-upper-col-in-best-forecast-columns">if lower_col in best_forecast.columns and upper_col in best_forecast.columns:</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-fill-between">ax.fill_between(</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id86">best_forecast[â€œdsâ€],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-lower-col">best_forecast[lower_col],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#best-forecast-upper-col">best_forecast[upper_col],</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-0-2">alpha=0.2,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#color-tab-orange">color=â€œtab:orangeâ€,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#label-90-interval">label=â€œ90% intervalâ€,</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id87">)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id88"></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-set-title-f-best-model-best-model-forecast-vs-actual">ax.set_title(fâ€Best Model ({best_model}) Forecast vs Actualâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-set-xlabel-date">ax.set_xlabel(â€œDateâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-set-ylabel-basis-spread">ax.set_ylabel(â€œBasis Spreadâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ax-legend-loc-upper-left">ax.legend(loc=â€œupper leftâ€)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id89">plt.tight_layout()</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#save-and-show-plot-example-forecasts-best-model-png">save_and_show_plot(â€œexample_forecasts_best_model.pngâ€)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#insights-and-conclusions">Insights and Conclusions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-findings">Key Findings:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-individual-model-analysis">Appendix: Individual Model Analysis</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeremiah Bejarano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024, Jeremiah Bejarano.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>